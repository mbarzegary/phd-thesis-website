<!DOCTYPE html><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>7 Model parallelization for high-performance computing‣ Mathematical and computational modeling of metallic biomaterials biodegradation</title>
<!--Generated on Sat Aug 31 17:26:45 2024 by LaTeXML (version 0.8.6) http://dlmf.nist.gov/LaTeXML/.-->
<!--Document created on KU Leuven, June 2023.-->

<link rel="stylesheet" href="LaTeXML.css" type="text/css">
<link rel="stylesheet" href="bookml/gitbook/css/style.css" type="text/css">
<link rel="stylesheet" href="bookml/gitbook/css/plugin-table.css" type="text/css">
<link rel="stylesheet" href="bookml/gitbook/css/plugin-search.css" type="text/css">
<link rel="stylesheet" href="bookml/gitbook/css/plugin-bookdown.css" type="text/css">
<link rel="stylesheet" href="bookml/gitbook/css/plugin-fontsettings.css" type="text/css">
<link rel="stylesheet" href="ltx-report.css" type="text/css">
<link rel="stylesheet" href="bookml/CSS/style.css" type="text/css">
<link rel="stylesheet" href="bookml/CSS/style.gitbook,plain.css" type="text/css">
<link rel="stylesheet" href="bookml/CSS/style.gitbook.css" type="text/css">
<link rel="stylesheet" href="bmluser/colors.gitbook-thesis.css" type="text/css">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6"></script>
<link rel="up" href="index.html" title="Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="start" href="index.html" title="Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="prev" href="Ch6.html" title="Chapter 6 Computational modeling of the neotissue growth process ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="next" href="Ch8.html" title="Chapter 8 BioDeg simulation software ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="chapter" href="Chx1.html" title="Abstract ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="chapter" href="Ch1.html" title="Chapter 1 General introduction ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="chapter" href="Ch2.html" title="Chapter 2 Aims and objectives ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="chapter" href="Ch3.html" title="Chapter 3 Developing the core computational model ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="chapter" href="Ch4.html" title="Chapter 4 Extending the model: adding fluid flow and convection ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="chapter" href="Ch5.html" title="Chapter 5 Extending the model: simulating local pH evolution ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="chapter" href="Ch6.html" title="Chapter 6 Computational modeling of the neotissue growth process ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="chapter" href="Ch8.html" title="Chapter 8 BioDeg simulation software ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="chapter" href="Ch9.html" title="Chapter 9 Bayesian parameter estimation of the computational models ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="chapter" href="Ch10.html" title="Chapter 10 Model applications: patient-specific porous acetabular implants ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="chapter" href="Ch11.html" title="Chapter 11 Model applications: mechanical integrity of infilled structures ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="chapter" href="Ch12.html" title="Chapter 12 Model applications: mechanical loosening of mandibular plates ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="chapter" href="Ch13.html" title="Chapter 13 Conclusion ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="bibliography" href="bib.html" title="Bibliography ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
<link rel="appendix" href="A1.html" title="Appendix A Mesh quality plots ‣ Mathematical and computational modeling of metallic biomaterials biodegradation">
</head>
<body>
<div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">
<a href="#bml-main-content" tabindex="0" class="bml-skip-to-content">Skip to content.</a>
<div class="book-summary"><nav class="ltx_page_navbar">
<ul class="ltx_toclist summary">
<li>
<a href="index.html" title="Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref" rel="start">Mathematical and computational modeling of metallic biomaterials biodegradation</a>
</li>
<li class="divider">
<li data-level="" data-path="Chx1.html" class="ltx_tocentry ltx_tocentry_chapter  chapter "><a href="Chx1.html" title="Abstract ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref">Abstract</a></li>
<li data-level="1" data-path="Ch1.html" class="ltx_tocentry ltx_tocentry_chapter  chapter "><a href="Ch1.html" title="Chapter 1 General introduction ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">1 </span></b>General introduction</a></li>
<li data-level="2" data-path="Ch2.html" class="ltx_tocentry ltx_tocentry_chapter  chapter "><a href="Ch2.html" title="Chapter 2 Aims and objectives ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">2 </span></b>Aims and objectives</a></li>
<li data-level="3" data-path="Ch3.html" class="ltx_tocentry ltx_tocentry_chapter  chapter "><a href="Ch3.html" title="Chapter 3 Developing the core computational model ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">3 </span></b>Developing the core computational model</a></li>
<li data-level="4" data-path="Ch4.html" class="ltx_tocentry ltx_tocentry_chapter  chapter "><a href="Ch4.html" title="Chapter 4 Extending the model: adding fluid flow and convection ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">4 </span></b>Extending the model: adding fluid flow and convection</a></li>
<li data-level="5" data-path="Ch5.html" class="ltx_tocentry ltx_tocentry_chapter  chapter "><a href="Ch5.html" title="Chapter 5 Extending the model: simulating local pH evolution ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">5 </span></b>Extending the model: simulating local pH evolution</a></li>
<li data-level="6" data-path="Ch6.html" class="ltx_tocentry ltx_tocentry_chapter  chapter "><a href="Ch6.html" title="Chapter 6 Computational modeling of the neotissue growth process ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">6 </span></b>Computational modeling of the neotissue growth process</a></li>
<li data-level="7" data-path="" class="ltx_tocentry ltx_tocentry_chapter ltx_ref_self  chapter active">
<a href="" title="Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7 </span></b>Model parallelization for high-performance computing</a>
<ul class="ltx_toclist ltx_toclist_chapter">
<li data-level="7.1" data-path="" class="ltx_tocentry ltx_tocentry_section  chapter "><a href="#S1" title="7.1 Introduction ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.1 </span></b>Introduction</a></li>
<li data-level="7.2" data-path="" class="ltx_tocentry ltx_tocentry_section  chapter ">
<a href="#S2" title="7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.2 </span></b>Background theory and model description</a>
<ul class="ltx_toclist ltx_toclist_section">
<li data-level="7.2.1" data-path="" class="ltx_tocentry ltx_tocentry_subsection  chapter "><a href="#S2.SS1" title="7.2.1 Chemistry of degradation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.2.1 </span></b>Chemistry of degradation</a></li>
<li data-level="7.2.2" data-path="" class="ltx_tocentry ltx_tocentry_subsection  chapter "><a href="#S2.SS2" title="7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.2.2 </span></b>Reaction-diffusion equation</a></li>
<li data-level="7.2.3" data-path="" class="ltx_tocentry ltx_tocentry_subsection  chapter "><a href="#S2.SS3" title="7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.2.3 </span></b>Level-set method</a></li>
</ul>
</li>
<li data-level="7.3" data-path="" class="ltx_tocentry ltx_tocentry_section  chapter ">
<a href="#S3" title="7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.3 </span></b>Methodology of model implementation</a>
<ul class="ltx_toclist ltx_toclist_section">
<li data-level="7.3.1" data-path="" class="ltx_tocentry ltx_tocentry_subsection  chapter "><a href="#S3.SS1" title="7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.3.1 </span></b>Finite element discretization</a></li>
<li data-level="7.3.2" data-path="" class="ltx_tocentry ltx_tocentry_subsection  chapter "><a href="#S3.SS2" title="7.3.2 Implementation and parallelization ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.3.2 </span></b>Implementation and parallelization</a></li>
<li data-level="7.3.3" data-path="" class="ltx_tocentry ltx_tocentry_subsection  chapter "><a href="#S3.SS3" title="7.3.3 Level-set issues ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.3.3 </span></b>Level-set issues</a></li>
<li data-level="7.3.4" data-path="" class="ltx_tocentry ltx_tocentry_subsection  chapter "><a href="#S3.SS4" title="7.3.4 Simulation setup ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.3.4 </span></b>Simulation setup</a></li>
<li data-level="7.3.5" data-path="" class="ltx_tocentry ltx_tocentry_subsection  chapter "><a href="#S3.SS5" title="7.3.5 Performance analysis ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.3.5 </span></b>Performance analysis</a></li>
<li data-level="7.3.6" data-path="" class="ltx_tocentry ltx_tocentry_subsection  chapter "><a href="#S3.SS6" title="7.3.6 Compute environment ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.3.6 </span></b>Compute environment</a></li>
</ul>
</li>
<li data-level="7.4" data-path="" class="ltx_tocentry ltx_tocentry_section  chapter ">
<a href="#S4" title="7.4 Results ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.4 </span></b>Results</a>
<ul class="ltx_toclist ltx_toclist_section">
<li data-level="7.4.1" data-path="" class="ltx_tocentry ltx_tocentry_subsection  chapter "><a href="#S4.SS1" title="7.4.1 Numerical simulation results ‣ 7.4 Results ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.4.1 </span></b>Numerical simulation results</a></li>
<li data-level="7.4.2" data-path="" class="ltx_tocentry ltx_tocentry_subsection  chapter "><a href="#S4.SS2" title="7.4.2 Weak and strong scaling results ‣ 7.4 Results ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.4.2 </span></b>Weak and strong scaling results</a></li>
</ul>
</li>
<li data-level="7.5" data-path="" class="ltx_tocentry ltx_tocentry_section  chapter "><a href="#S5" title="7.5 Discussion ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.5 </span></b>Discussion</a></li>
<li data-level="7.6" data-path="" class="ltx_tocentry ltx_tocentry_section  chapter "><a href="#S6" title="7.6 Conclusion ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.6 </span></b>Conclusion</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li data-level="7.A" data-path="" class="ltx_tocentry ltx_tocentry_appendix  chapter "><a href="#A1" title="Appendix 7.A Comparing the performance of different combinations of KSP types and preconditioners ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">7.A </span></b>Comparing different preconditioners and solvers</a></li>
</ul>
</li>
<li data-level="8" data-path="Ch8.html" class="ltx_tocentry ltx_tocentry_chapter  chapter "><a href="Ch8.html" title="Chapter 8 BioDeg simulation software ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">8 </span></b>BioDeg simulation software</a></li>
<li data-level="9" data-path="Ch9.html" class="ltx_tocentry ltx_tocentry_chapter  chapter "><a href="Ch9.html" title="Chapter 9 Bayesian parameter estimation of the computational models ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">9 </span></b>Bayesian parameter estimation of the computational models</a></li>
<li data-level="10" data-path="Ch10.html" class="ltx_tocentry ltx_tocentry_chapter  chapter "><a href="Ch10.html" title="Chapter 10 Model applications: patient-specific porous acetabular implants ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">10 </span></b>Model applications: patient-specific porous acetabular implants</a></li>
<li data-level="11" data-path="Ch11.html" class="ltx_tocentry ltx_tocentry_chapter  chapter "><a href="Ch11.html" title="Chapter 11 Model applications: mechanical integrity of infilled structures ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">11 </span></b>Model applications: mechanical integrity of infilled structures</a></li>
<li data-level="12" data-path="Ch12.html" class="ltx_tocentry ltx_tocentry_chapter  chapter "><a href="Ch12.html" title="Chapter 12 Model applications: mechanical loosening of mandibular plates ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">12 </span></b>Model applications: mechanical loosening of mandibular plates</a></li>
<li data-level="13" data-path="Ch13.html" class="ltx_tocentry ltx_tocentry_chapter  chapter "><a href="Ch13.html" title="Chapter 13 Conclusion ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">13 </span></b>Conclusion</a></li>
<li data-level="" data-path="bib.html" class="ltx_tocentry ltx_tocentry_bibliography  chapter "><a href="bib.html" title="Bibliography ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref">Bibliography</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li data-level="A" data-path="A1.html" class="ltx_tocentry ltx_tocentry_appendix  chapter "><a href="A1.html" title="Appendix A Mesh quality plots ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><b><span class="ltx_tag ltx_tag_ref">A </span></b>Mesh quality plots</a></li>
</ul>
</nav></div>
<div class="ltx_page_main book-body fixed">
<div class="body-inner">
<div class="book-header fixed" role="navigation"><h1>Model parallelization for high-performance computing</h1></div>
<div class="page-wrapper" tabindex="-1" role="main">
<div class="ltx_page_content page-inner" id="bml-main-content">
<section class="ltx_chapter normal">
<div class="section level1">

<h1 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter header-section-number">Chapter 7</span> Model parallelization for high-performance computing</h1>

<div id="p1" class="ltx_para ltx_noindent">
<p class="ltx_p">
<span class="ltx_inline-block ltx_parbox ltx_align_middle ltx_framed_rectangle" style="padding:9pt;width:433.6pt;">
<span class="ltx_p">This chapter is based on previously published content in <span class="ltx_text ltx_font_italic">The International Journal of High Performance Computing Applications</span>:</span>
<span class="ltx_p">M. Barzegari, and L. Geris, “Highly scalable numerical simulation of coupled reaction–diffusion systems with moving interfaces,” <span class="ltx_text ltx_font_italic">The International Journal of High Performance Computing Applications</span>, vol. 36, pp. 198-213, 2022.</span>
</span></p>
</div>
<div id="p2" class="ltx_para">
<p class="ltx_p">A combination of reaction-diffusion models with moving-boundary problems yields a system in which the diffusion (spreading and penetration) and reaction (transformation) evolve the system’s state and geometry over time. These systems can be used in a wide range of engineering applications. In this study, as an example of such a system, the degradation of metallic materials is investigated. A mathematical model is constructed of the diffusion-reaction processes and the movement of corrosion front of a magnesium block floating in a chemical solution. The corresponding parallelized computational model is implemented using the finite element method, and the weak and strong scaling behaviors of the model are evaluated to analyze the performance and efficiency of the employed high-performance computing techniques.</p>
</div>
<section id="S1" class="ltx_section normal">
<div class="section level2">

<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section header-section-number">7.1</span> Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p class="ltx_p">Moving-boundary problems <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib38" title="Free and moving boundary problems" class="ltx_ref">59</a>]</cite> are a subset of the general concept of boundary-value problems which not only require the solution of the underlying partial differential equation (PDE), but also the determination of the boundary of the domain (or sub-domains) as part of the solution. Moving-boundary problems are usually referred to as Stefan problems <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib38" title="Free and moving boundary problems" class="ltx_ref">59</a>]</cite> and can be used to model a plethora of phenomena ranging from phase separation and multiphase flows in materials engineering to bone development and tumor growth in biology. Reaction-diffusion systems are the mathematical models in which the change of state variables occurs via transformation and spreading. These systems are described by a set of parabolic PDEs and can model a large number of different systems in science and engineering, for instance predator-prey models in biology and chemical components reactions in chemistry <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib40" title="The theory and applications of reaction-diffusion equations : patterns and waves" class="ltx_ref">96</a>]</cite>. Combining the reaction-diffusion systems with moving-boundary problems provides a way to study the systems in which the diffusion and reaction lead to the change of domain geometry. Such systems have great importance in various real-world scenarios in chemistry and chemical engineering as well as environmental and life sciences.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p class="ltx_p">In this study, the material degradation phenomenon has been investigated as an example of a reaction-diffusion system with moving boundaries, in which the loss of material due to corrosion leads to movement of the interface of the bulk material and surrounding corrosion environment. More specifically, the degradation of magnesium (Mg) in simulated body fluid has been chosen as a case study. Magnesium has been chosen due to its growing usability as a degradable material in biomedicine, where it is usually used in biodegradable implants for bone tissue engineering and cardiovascular applications <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib39" title="Recent advances on the development of magnesium alloys for biodegradable implants" class="ltx_ref">55</a>, <a href="bib.html#bib3" title="Current status on clinical applications of magnesium-based orthopaedic implants: a review from clinical translational perspective" class="ltx_ref">296</a>]</cite>. The ultimate application of such a model can be then to study the degradation behavior of resorbable Mg-based biomaterials.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p class="ltx_p">A wide range of different techniques has already been developed to study the moving interfaces in reaction-diffusion problems, which can be grouped into 3 main categories: 1) mesh elimination techniques, in which some elements are eliminated to simulate the interface movement (or loss of material in corrosion problems), 2) explicit surface representation, such as the arbitrary Lagrangian-Eulerian (ALE) method, which tracks the interface by moving a Lagrangian mesh inside an Eulerian grid, and 3) implicit surface tracking, in which an implicit criterion is responsible to define the moving interface during the reaction-diffusion process. Related to the aforementioned case study, studies performed by <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib49" title="A quantitative study on magnesium alloy stent biodegradation" class="ltx_ref">82</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib50" title="Continuum damage model for bioresorbable magnesium alloy devices — application to coronary stents" class="ltx_ref">86</a>]</cite> are examples of the first group. <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib49" title="A quantitative study on magnesium alloy stent biodegradation" class="ltx_ref">82</a>]</cite> have constructed a simulation of degradation using the mesh elimination technique. <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib50" title="Continuum damage model for bioresorbable magnesium alloy devices — application to coronary stents" class="ltx_ref">86</a>]</cite> have developed a continuous damage (CD) model by using an explicit solver to study the degradation. The work of <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib52" title="A physical corrosion model for bioabsorbable metal stents" class="ltx_ref">98</a>]</cite> is an example of the second group as they have developed one of the first models to correlate the mass flux of the metallic ions in the biodegradation interface to the velocity of said interface. This was used to build an ALE model to explicitly track the boundary of the material during degradation. Studies of the third category are based more on mathematical modeling rather than available models in simulation software packages. This approach results in more flexibility and control over the implementation of the computational model. For instance, <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib51" title="An adaptive level set approach for modeling damage due to galvanic corrosion" class="ltx_ref">275</a>]</cite> have derived a system of mathematical equations to study galvanic corrosion of metals, taking advantage of the level set method (LSM) to track the corrosion front. <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib53" title="Mathematical modelling of the degradation behaviour of biodegradable metals" class="ltx_ref">23</a>]</cite> have used the definition of velocity of the biodegradation interface as the speed of the moving boundary in LSM, enabling them to track the geometrical changes of the material during degradation. Similarly, <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib106" title="An extended finite-element model coupled with level set method for analysis of growth of corrosion pits in metallic structures" class="ltx_ref">256</a>]</cite> have used a combination of LSM and extended finite element method (XFEM), a method to model regions with spatial discontinuities, to study the moving corrosion front in the pitting corrosion process. A very similar approach and formulation has been taken by <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib107" title="Numerical modeling of corrosion pit propagation using the combined extended finite element and level set method" class="ltx_ref">70</a>]</cite> to model localized pitting corrosion. An alternative method for tracking the moving interface is the phase field method, which has been used in a wide range of relevant studies. A comparison between the behavior of phase-field and LSM formulations for an evolving solid-liquid interface has been performed by <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib108" title="Phase field and level set methods for modeling solute precipitation and/or dissolution" class="ltx_ref">285</a>]</cite>, showing that both methods lead to the same results for diffusion-reaction systems. The approach taken in this study was similar to the one from Bjger et al., where LSM was employed to correlate the diffusion and reaction processes to the movement of the solid-solution interface using continuous variables.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p class="ltx_p">Tracking the moving front at the diffusion interface requires high numerical accuracy of the diffusive state variables, which can be achieved using a refined computational grid. This makes the model computationally intensive, and as a consequence, implementing parallelization is an inevitable aspect of simulating such a model. Such an approach enables the model to simulate large-scale systems with a large number of degrees of freedom (DOF) in 3D with higher performance and efficiency in high-performance computing (HPC) environments. In recent years, parallelization of diffusion-reaction systems simulation has been investigated, but the studies are mainly conducted for stochastic (statistical) models. For instance, <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib57" title="Parallel STEPS: large scale stochastic spatial reaction-diffusion simulation with high performance computers" class="ltx_ref">53</a>]</cite> have developed a parallel stochastic model for large-scale spatial reaction-diffusion simulation, and similarly, <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib58" title="pSpatiocyte: a high-performance simulator for intracellular reaction-diffusion systems" class="ltx_ref">18</a>]</cite> have developed a stochastic high-performance simulator for specific biological applications. Also as an example for massively parallel systems, <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib59" title="Simulation of reaction diffusion processes over biologically relevant size and time scales using multi-GPU workstations" class="ltx_ref">107</a>]</cite> have conducted a simulation of reaction-diffusion processes in biology using graphics processing units (GPUs). Although stochastic models have more parallel-friendly algorithms, explaining the underlying process, especially when it involves reaction-diffusion processes of chemistry and biology, is less complex and more universal using mechanistic (deterministic) models, which are based on well-developed mathematical models of continuous systems <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib98" title="WHY DO POPULATIONS CYCLE? a SYNTHESIS OF STATISTICAL AND MECHANISTIC MODELING APPROACHES" class="ltx_ref">147</a>]</cite>. To the best of authors’ knowledge, none of the previous contributions to the topic of reaction-diffusion systems with moving interfaces has employed parallelization techniques to increase the performance and speed of execution of the model without compromising the accuracy of the interface tracking.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p class="ltx_p">In the current study, we developed a mechanistic model of a reaction-diffusion system coupled with a moving interface problem. Improving the accuracy of the interface capturing requires a refined computational mesh, leading to a more computation-intensive simulation. To overcome this challenge and yield more interactable simulations, scalable parallelization techniques were implemented making the model capable of being run on massively parallel systems to reduce the simulation time. The investigated case-study is the
material degradation process. The developed model captures the release of metallic ions to the medium, formation of a protective film on the surface of the material, the effect of presented ions in the medium on the thickness of this protection layer, and tracking of the movement of the corrosion front (Fig. <a href="#F1" title="Figure 7.1 ‣ 7.1 Introduction ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.1</span></a>). The interface tracking was performed using an implicit distance function that defined the position of the interface during degradation. This implicit function was obtained by constructing and solving a level set model. It is also worth noting that in a real-world application, such systems require a calibration (also called parameter estimation or inverse problem), in which the model should be simulated hundreds of times. This makes the parallelization even more crucial for these models.</p>
</div>
<figure id="F1" class="ltx_figure"><div class="bml-overflow-wrapper"><img src="chapters/hpc/image/schematic.jpg" id="F1.g1" class="ltx_graphics ltx_centering" width="486" height="126" alt="A schematic presentation of different components of the developed model for simulation of the degradation process with a moving front."></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.1: </span>A schematic presentation of different components of the developed model for simulation of the degradation process with a moving front.</figcaption>
</figure>
</div>
</section>
<section id="S2" class="ltx_section normal">
<div class="section level2">

<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section header-section-number">7.2</span> Background theory and model description</h2>

<div id="S2.p1" class="ltx_para">
<p class="ltx_p">Before elaborating the parallel implementation strategy, the mathematical model is briefly described in this section. The model is constructed based on the chemistry of degradation, starting from the previous work by <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib53" title="Mathematical modelling of the degradation behaviour of biodegradable metals" class="ltx_ref">23</a>]</cite>, in which the ions can diffuse to the medium and react with each other.</p>
</div>
<section id="S2.SS1" class="ltx_subsection normal">
<div class="section level3">

<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection header-section-number">7.2.1</span> Chemistry of degradation</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p class="ltx_p">In metals, degradation occurs through the corrosion process, which usually consists of electrochemical reactions, including anodic and cathodic reactions as well as the formation of side products <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib1" title="Biodegradable metals" class="ltx_ref">299</a>]</cite>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p class="ltx_p">For Mg, the corrosion reactions comprise the following steps <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib1" title="Biodegradable metals" class="ltx_ref">299</a>]</cite>: first, the material is released as metallic ions and free electrons, which causes the volume of the bulk material to be reduced:</p>
<div id="E1" class="ltx_equation ltx_eqn_div">
<span><math id="E1.m1" class="ltx_Math" alttext="\mathrm{Mg}\longrightarrow\mathrm{Mg}^{2+}+2\mathrm{e}^{-}." display="block"><semantics><mrow><mrow><mi>Mg</mi><mo>⟶</mo><mrow><msup><mi>Mg</mi><mrow><mn>2</mn><mo>+</mo></mrow></msup><mo>+</mo><mrow><mn>2</mn><mo>⁢</mo><msup><mi mathvariant="normal">e</mi><mo>-</mo></msup></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\mathrm{Mg}\longrightarrow\mathrm{Mg}^{2+}+2\mathrm{e}^{-}.</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.1)</span>
              
              
            
</div>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p class="ltx_p">The free electron reduces water to hydrogen gas and hydroxide ions:</p>
<div id="E2" class="ltx_equation ltx_eqn_div">
<span><math id="E2.m1" class="ltx_Math" alttext="2\mathrm{H}_{2}\mathrm{O}+2\mathrm{e}^{-}\longrightarrow\mathrm{H}_{2}+2%
\mathrm{OH}^{-}." display="block"><semantics><mrow><mrow><mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi mathvariant="normal">H</mi><mn>2</mn></msub><mo>⁢</mo><mi mathvariant="normal">O</mi></mrow><mo>+</mo><mrow><mn>2</mn><mo>⁢</mo><msup><mi mathvariant="normal">e</mi><mo>-</mo></msup></mrow></mrow><mo>⟶</mo><mrow><msub><mi mathvariant="normal">H</mi><mn>2</mn></msub><mo>+</mo><mrow><mn>2</mn><mo>⁢</mo><mi mathvariant="normal">O</mi><mo>⁢</mo><msup><mi mathvariant="normal">H</mi><mo>-</mo></msup></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">2\mathrm{H}_{2}\mathrm{O}+2\mathrm{e}^{-}\longrightarrow\mathrm{H}_{2}+2%
\mathrm{OH}^{-}.</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.2)</span>
              
              
            
</div>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p class="ltx_p">Then, with the combination of the metallic and hydroxide ions, a porous film is formed on the surface, slowing down the degradation rate by protecting the material underneath:</p>
<div id="E3" class="ltx_equation ltx_eqn_div">
<span><math id="E3.m1" class="ltx_Math" alttext="\mathrm{Mg}^{2+}+2\mathrm{OH}^{-}\longrightarrow\mathrm{Mg}(\mathrm{OH})_{2}." display="block"><semantics><mrow><mrow><mrow><msup><mi>Mg</mi><mrow><mn>2</mn><mo>+</mo></mrow></msup><mo>+</mo><mrow><mn>2</mn><mo>⁢</mo><mi mathvariant="normal">O</mi><mo>⁢</mo><msup><mi mathvariant="normal">H</mi><mo>-</mo></msup></mrow></mrow><mo>⟶</mo><mrow><mi>Mg</mi><mo>⁢</mo><msub><mrow><mo stretchy="false">(</mo><mi>OH</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msub></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\mathrm{Mg}^{2+}+2\mathrm{OH}^{-}\longrightarrow\mathrm{Mg}(\mathrm{OH})_{2}.</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.3)</span>
              
              
            
</div>
</div>
<div id="S2.SS1.p5" class="ltx_para">
<p class="ltx_p">With the presence of some specific ions in the surrounding medium, such as chloride ions in a saline solution, the protective film might be broken partially, which contributes to an increase of the rate of degradation:</p>
<div id="E4" class="ltx_equation ltx_eqn_div">
<span><math id="E4.m1" class="ltx_Math" alttext="\mathrm{Mg}(\mathrm{OH})_{2}+2\mathrm{Cl}^{-}\longrightarrow\mathrm{Mg}^{2+}+2%
\mathrm{Cl}^{-}+2\mathrm{OH}^{-}." display="block"><semantics><mrow><mrow><mrow><mrow><mi>Mg</mi><mo>⁢</mo><msub><mrow><mo stretchy="false">(</mo><mi>OH</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msub></mrow><mo>+</mo><mrow><mn>2</mn><mo>⁢</mo><mi mathvariant="normal">C</mi><mo>⁢</mo><msup><mi mathvariant="normal">l</mi><mo>-</mo></msup></mrow></mrow><mo>⟶</mo><mrow><msup><mi>Mg</mi><mrow><mn>2</mn><mo>+</mo></mrow></msup><mo>+</mo><mrow><mn>2</mn><mo>⁢</mo><mi mathvariant="normal">C</mi><mo>⁢</mo><msup><mi mathvariant="normal">l</mi><mo>-</mo></msup></mrow><mo>+</mo><mrow><mn>2</mn><mo>⁢</mo><mi mathvariant="normal">O</mi><mo>⁢</mo><msup><mi mathvariant="normal">H</mi><mo>-</mo></msup></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\mathrm{Mg}(\mathrm{OH})_{2}+2\mathrm{Cl}^{-}\longrightarrow\mathrm{Mg}^{2+}+2%
\mathrm{Cl}^{-}+2\mathrm{OH}^{-}.</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.4)</span>
              
              
            
</div>
</div>
<div id="S2.SS1.p6" class="ltx_para">
<p class="ltx_p">The degradation process of metals is a continuous repetition of the above reactions.</p>
</div>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection normal">
<div class="section level3">

<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection header-section-number">7.2.2</span> Reaction-diffusion equation</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A reaction-diffusion partial differential equation can describe the state of a reaction-diffusion system by tracking the change of the concentration of the different components of the system over time <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib40" title="The theory and applications of reaction-diffusion equations : patterns and waves" class="ltx_ref">96</a>]</cite>. The equation is a parabolic PDE and can be expressed as</p>
<div id="E5" class="ltx_equation ltx_eqn_div">
<span><math id="E5.m1" class="ltx_Math" alttext="\frac{\partial u}{\partial t}-\nabla\cdot[D\nabla u]=f(u)" display="block"><semantics><mrow><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>t</mi></mrow></mfrac><mo>-</mo><mrow><mo>∇</mo><mo>⋅</mo><mrow><mo stretchy="false">[</mo><mrow><mi>D</mi><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>u</mi></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><mo>=</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\frac{\partial u}{\partial t}-\nabla\cdot[D\nabla u]=f(u)</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.5)</span>
              
              
            
</div>
<p class="ltx_p">in which the change of the state variable <math id="S2.SS2.p1.m1" class="ltx_Math" alttext="u=u(\mathbf{x},t),\mathbf{x}\in\Omega\subset\mathbb{R}^{3}" display="inline"><semantics><mrow><mrow><mi>u</mi><mo>=</mo><mrow><mi>u</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐱</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo><mrow><mi>𝐱</mi><mo>∈</mo><mi mathvariant="normal">Ω</mi><mo>⊂</mo><msup><mi>ℝ</mi><mn>3</mn></msup></mrow></mrow><annotation encoding="application/x-tex">u=u(\mathbf{x},t),\mathbf{x}\in\Omega\subset\mathbb{R}^{3}</annotation></semantics></math> is described as a combination of how it diffuses and how it is produced or eliminated via reactions. The term <math id="S2.SS2.p1.m2" class="ltx_Math" alttext="f(u)" display="inline"><semantics><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>u</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(u)</annotation></semantics></math> is a smooth function that describes the reaction processes.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p class="ltx_p">In the example used in this study, the state variable in Eq. <a href="#E5" title="(7.5) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.5</span></a> is the concentration of effective chemical components involved in the degradation process, namely magnesium ions and the protective layer, denoted by <math id="S2.SS2.p2.m1" class="ltx_Math" alttext="C_{\mathrm{Mg}}" display="inline"><semantics><msub><mi>C</mi><mi>Mg</mi></msub><annotation encoding="application/x-tex">C_{\mathrm{Mg}}</annotation></semantics></math> and <math id="S2.SS2.p2.m2" class="ltx_Math" alttext="C_{\mathrm{Film}}" display="inline"><semantics><msub><mi>C</mi><mi>Film</mi></msub><annotation encoding="application/x-tex">C_{\mathrm{Film}}</annotation></semantics></math> respectively.</p>
<div id="E6" class="ltx_equation ltx_eqn_div">
<span><math id="E6.m1" class="ltx_Math" alttext="C_{\mathrm{Mg}}=C_{\mathrm{Mg}}(\mathbf{x},t),\quad C_{\mathrm{Film}}=C_{%
\mathrm{Film}}(\mathbf{x},t)\quad\mathbf{x}\in\Omega\subset\mathbb{R}^{3}" display="block"><semantics><mrow><mrow><msub><mi>C</mi><mi>Mg</mi></msub><mo>=</mo><mrow><msub><mi>C</mi><mi>Mg</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐱</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo rspace="12.5pt">,</mo><mrow><mrow><msub><mi>C</mi><mi>Film</mi></msub><mo>=</mo><mrow><msub><mi>C</mi><mi>Film</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐱</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo mathvariant="italic" separator="true"> </mo><mrow><mi>𝐱</mi><mo>∈</mo><mi mathvariant="normal">Ω</mi><mo>⊂</mo><msup><mi>ℝ</mi><mn>3</mn></msup></mrow></mrow></mrow><annotation encoding="application/x-tex">C_{\mathrm{Mg}}=C_{\mathrm{Mg}}(\mathbf{x},t),\quad C_{\mathrm{Film}}=C_{%
\mathrm{Film}}(\mathbf{x},t)\quad\mathbf{x}\in\Omega\subset\mathbb{R}^{3}</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.6)</span>
              
              
            
</div>
</div>
<div id="S2.SS2.p3" class="ltx_para ltx_noindent">
<p class="ltx_p"><math id="S2.SS2.p3.m1" class="ltx_Math" alttext="\Omega" display="inline"><semantics><mi mathvariant="normal">Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math> is the whole domain of interest, including the bulk material and its surrounding medium. So, by assuming that the reaction rates of Eqs. <a href="#E3" title="(7.3) ‣ 7.2.1 Chemistry of degradation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.3</span></a> and <a href="#E4" title="(7.4) ‣ 7.2.1 Chemistry of degradation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.4</span></a> are <math id="S2.SS2.p3.m2" class="ltx_Math" alttext="k_{1}" display="inline"><semantics><msub><mi>k</mi><mn>1</mn></msub><annotation encoding="application/x-tex">k_{1}</annotation></semantics></math> and <math id="S2.SS2.p3.m3" class="ltx_Math" alttext="k_{2}" display="inline"><semantics><msub><mi>k</mi><mn>2</mn></msub><annotation encoding="application/x-tex">k_{2}</annotation></semantics></math> respectively, one can write the change of those state variables according to Eq. <a href="#E3" title="(7.3) ‣ 7.2.1 Chemistry of degradation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.3</span></a> and Eq. <a href="#E4" title="(7.4) ‣ 7.2.1 Chemistry of degradation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.4</span></a> as</p>
<div id="E7" class="ltx_equation ltx_eqn_div">
<span><math id="E7.m1" class="ltx_Math" alttext="\frac{\partial C_{\mathrm{Mg}}}{\partial t}=\nabla\cdot\left(D_{\mathrm{Mg}}^{%
e}\nabla C_{\mathrm{Mg}}\right)-k_{1}C_{\mathrm{Mg}}+k_{2}C_{\mathrm{Film}}[%
\mathrm{Cl}]^{2}" display="block"><semantics><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>C</mi><mi>Mg</mi></msub></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mrow><mrow><mo>∇</mo><mo>⋅</mo><mrow><mo>(</mo><mrow><msubsup><mi>D</mi><mi>Mg</mi><mi>e</mi></msubsup><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><msub><mi>C</mi><mi>Mg</mi></msub></mrow></mrow><mo>)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>C</mi><mi>Mg</mi></msub></mrow></mrow><mo>+</mo><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>⁢</mo><msub><mi>C</mi><mi>Film</mi></msub><mo>⁢</mo><msup><mrow><mo stretchy="false">[</mo><mi>Cl</mi><mo stretchy="false">]</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow><annotation encoding="application/x-tex">\frac{\partial C_{\mathrm{Mg}}}{\partial t}=\nabla\cdot\left(D_{\mathrm{Mg}}^{%
e}\nabla C_{\mathrm{Mg}}\right)-k_{1}C_{\mathrm{Mg}}+k_{2}C_{\mathrm{Film}}[%
\mathrm{Cl}]^{2}</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.7)</span>
              
              
            
</div>
</div>
<div id="S2.SS2.p4" class="ltx_para">
<div id="E8" class="ltx_equation ltx_eqn_div">
<span><math id="E8.m1" class="ltx_Math" alttext="\frac{\partial C_{\mathrm{Film}}}{\partial t}=k_{1}C_{\mathrm{Mg}}-k_{2}C_{%
\mathrm{Film}}[\mathrm{Cl}]^{2}." display="block"><semantics><mrow><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>C</mi><mi>Film</mi></msub></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>C</mi><mi>Mg</mi></msub></mrow><mo>-</mo><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>⁢</mo><msub><mi>C</mi><mi>Film</mi></msub><mo>⁢</mo><msup><mrow><mo stretchy="false">[</mo><mi>Cl</mi><mo stretchy="false">]</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\frac{\partial C_{\mathrm{Film}}}{\partial t}=k_{1}C_{\mathrm{Mg}}-k_{2}C_{%
\mathrm{Film}}[\mathrm{Cl}]^{2}.</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.8)</span>
              
              
            
</div>
</div>
<div id="S2.SS2.p5" class="ltx_para ltx_noindent">
<p class="ltx_p">We assumed that the concentration of the chloride ions is constant (denoted by <math id="S2.SS2.p5.m1" class="ltx_Math" alttext="[\mathrm{Cl}]" display="inline"><semantics><mrow><mo stretchy="false">[</mo><mi>Cl</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mathrm{Cl}]</annotation></semantics></math> in the equation) and does not diffuse into the protective film. The missing part of the model described by Eqs. <a href="#E7" title="(7.7) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.7</span></a> and <a href="#E8" title="(7.8) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.8</span></a> is the effect of the protective film on the reduction of the degradation rate. To this end, we defined a saturation term, <math id="S2.SS2.p5.m2" class="ltx_Math" alttext="(1-\frac{C_{\mathrm{Film}}}{[\mathrm{Film}]_{\max}})" display="inline"><semantics><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>-</mo><mfrac><msub><mi>C</mi><mi>Film</mi></msub><msub><mrow><mo stretchy="false">[</mo><mi>Film</mi><mo stretchy="false">]</mo></mrow><mi>max</mi></msub></mfrac></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1-\frac{C_{\mathrm{Film}}}{[\mathrm{Film}]_{\max}})</annotation></semantics></math> for the concentration of Mg ions in the equations. By considering the film’s porosity (<math id="S2.SS2.p5.m3" class="ltx_Math" alttext="\epsilon" display="inline"><semantics><mi>ϵ</mi><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math>), the maximum concentration of the protective layer can be calculated based on its density (<math id="S2.SS2.p5.m4" class="ltx_Math" alttext="\rho_{\mathrm{Mg}(\mathrm{OH})_{2}}" display="inline"><semantics><msub><mi>ρ</mi><mrow><mi>Mg</mi><mo>⁢</mo><msub><mrow><mo stretchy="false">(</mo><mi>OH</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msub></mrow></msub><annotation encoding="application/x-tex">\rho_{\mathrm{Mg}(\mathrm{OH})_{2}}</annotation></semantics></math>):</p>
<div id="E9" class="ltx_equation ltx_eqn_div">
<span><math id="E9.m1" class="ltx_Math" alttext="[\mathrm{Film}]_{\max}=\rho_{\mathrm{Mg}(\mathrm{OH})_{2}}\cdot(1-\epsilon)." display="block"><semantics><mrow><mrow><msub><mrow><mo stretchy="false">[</mo><mi>Film</mi><mo stretchy="false">]</mo></mrow><mi>max</mi></msub><mo>=</mo><mrow><msub><mi>ρ</mi><mrow><mi>Mg</mi><mo>⁢</mo><msub><mrow><mo stretchy="false">(</mo><mi>OH</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msub></mrow></msub><mo>⋅</mo><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>-</mo><mi>ϵ</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">[\mathrm{Film}]_{\max}=\rho_{\mathrm{Mg}(\mathrm{OH})_{2}}\cdot(1-\epsilon).</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.9)</span>
              
              
            
</div>
</div>
<div id="S2.SS2.p6" class="ltx_para">
<p class="ltx_p">The defined saturation term acts as a function of space that varies between 0 and 1 in each point. By adding this term to the concentration of Mg ions, we can write</p>
<div id="E10" class="ltx_equation ltx_eqn_div">
<span><math id="E10.m1" class="ltx_Math" alttext="\frac{\partial C_{\mathrm{Mg}}}{\partial t}=\nabla\cdot\left(D_{\mathrm{Mg}}^{%
e}\nabla C_{\mathrm{Mg}}\right)-k_{1}C_{\mathrm{Mg}}\left(1-\frac{C_{\mathrm{%
Film}}}{[\mathrm{Film}]_{\max}}\right)+k_{2}C_{\mathrm{Film}}[\mathrm{Cl}]^{2}" display="block"><semantics><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>C</mi><mi>Mg</mi></msub></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mrow><mrow><mo>∇</mo><mo>⋅</mo><mrow><mo>(</mo><mrow><msubsup><mi>D</mi><mi>Mg</mi><mi>e</mi></msubsup><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><msub><mi>C</mi><mi>Mg</mi></msub></mrow></mrow><mo>)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>C</mi><mi>Mg</mi></msub><mo>⁢</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mfrac><msub><mi>C</mi><mi>Film</mi></msub><msub><mrow><mo stretchy="false">[</mo><mi>Film</mi><mo stretchy="false">]</mo></mrow><mi>max</mi></msub></mfrac></mrow><mo>)</mo></mrow></mrow></mrow><mo>+</mo><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>⁢</mo><msub><mi>C</mi><mi>Film</mi></msub><mo>⁢</mo><msup><mrow><mo stretchy="false">[</mo><mi>Cl</mi><mo stretchy="false">]</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow><annotation encoding="application/x-tex">\frac{\partial C_{\mathrm{Mg}}}{\partial t}=\nabla\cdot\left(D_{\mathrm{Mg}}^{%
e}\nabla C_{\mathrm{Mg}}\right)-k_{1}C_{\mathrm{Mg}}\left(1-\frac{C_{\mathrm{%
Film}}}{[\mathrm{Film}]_{\max}}\right)+k_{2}C_{\mathrm{Film}}[\mathrm{Cl}]^{2}</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.10)</span>
              
              
            
</div>
</div>
<div id="S2.SS2.p7" class="ltx_para">
<div id="E11" class="ltx_equation ltx_eqn_div">
<span><math id="E11.m1" class="ltx_Math" alttext="\frac{\partial C_{\mathrm{Film}}}{\partial t}=k_{1}C_{\mathrm{Mg}}\left(1-%
\frac{C_{\mathrm{Film}}}{[\mathrm{Film}]_{\max}}\right)-k_{2}C_{\mathrm{Film}}%
[\mathrm{Cl}]^{2}." display="block"><semantics><mrow><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><msub><mi>C</mi><mi>Film</mi></msub></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>⁢</mo><msub><mi>C</mi><mi>Mg</mi></msub><mo>⁢</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mfrac><msub><mi>C</mi><mi>Film</mi></msub><msub><mrow><mo stretchy="false">[</mo><mi>Film</mi><mo stretchy="false">]</mo></mrow><mi>max</mi></msub></mfrac></mrow><mo>)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>⁢</mo><msub><mi>C</mi><mi>Film</mi></msub><mo>⁢</mo><msup><mrow><mo stretchy="false">[</mo><mi>Cl</mi><mo stretchy="false">]</mo></mrow><mn>2</mn></msup></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\frac{\partial C_{\mathrm{Film}}}{\partial t}=k_{1}C_{\mathrm{Mg}}\left(1-%
\frac{C_{\mathrm{Film}}}{[\mathrm{Film}]_{\max}}\right)-k_{2}C_{\mathrm{Film}}%
[\mathrm{Cl}]^{2}.</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.11)</span>
              
              
            
</div>
</div>
<div id="S2.SS2.p8" class="ltx_para">
<p class="ltx_p">Since the film is a porous layer and allows the ions to diffuse through it, the diffusion coefficient in Eq. <a href="#E10" title="(7.10) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.10</span></a> is a function of space and not a constant value (which is the reason for being denoted as <math id="S2.SS2.p8.m1" class="ltx_Math" alttext="D_{\mathrm{Mg}}^{e}" display="inline"><semantics><msubsup><mi>D</mi><mi>Mg</mi><mi>e</mi></msubsup><annotation encoding="application/x-tex">D_{\mathrm{Mg}}^{e}</annotation></semantics></math>). We can calculate this effective diffusion function by interpolating two values at any point: 1) <math id="S2.SS2.p8.m2" class="ltx_Math" alttext="D_{\mathrm{Mg}}^{e}=D_{\mathrm{Mg}}" display="inline"><semantics><mrow><msubsup><mi>D</mi><mi>Mg</mi><mi>e</mi></msubsup><mo>=</mo><msub><mi>D</mi><mi>Mg</mi></msub></mrow><annotation encoding="application/x-tex">D_{\mathrm{Mg}}^{e}=D_{\mathrm{Mg}}</annotation></semantics></math> when <math id="S2.SS2.p8.m3" class="ltx_Math" alttext="C_{\mathrm{Film}}=0" display="inline"><semantics><mrow><msub><mi>C</mi><mi>Film</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">C_{\mathrm{Film}}=0</annotation></semantics></math>, and 2) <math id="S2.SS2.p8.m4" class="ltx_Math" alttext="D_{\mathrm{Mg}}^{e}=\frac{\epsilon}{\tau}D_{\mathrm{Mg}}" display="inline"><semantics><mrow><msubsup><mi>D</mi><mi>Mg</mi><mi>e</mi></msubsup><mo>=</mo><mrow><mfrac><mi>ϵ</mi><mi>τ</mi></mfrac><mo>⁢</mo><msub><mi>D</mi><mi>Mg</mi></msub></mrow></mrow><annotation encoding="application/x-tex">D_{\mathrm{Mg}}^{e}=\frac{\epsilon}{\tau}D_{\mathrm{Mg}}</annotation></semantics></math> when <math id="S2.SS2.p8.m5" class="ltx_Math" alttext="C_{\mathrm{Film}}=[\mathrm{Film}]_{\max}" display="inline"><semantics><mrow><msub><mi>C</mi><mi>Film</mi></msub><mo>=</mo><msub><mrow><mo stretchy="false">[</mo><mi>Film</mi><mo stretchy="false">]</mo></mrow><mi>max</mi></msub></mrow><annotation encoding="application/x-tex">C_{\mathrm{Film}}=[\mathrm{Film}]_{\max}</annotation></semantics></math>, in which <math id="S2.SS2.p8.m6" class="ltx_Math" alttext="\epsilon" display="inline"><semantics><mi>ϵ</mi><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math> and <math id="S2.SS2.p8.m7" class="ltx_Math" alttext="\tau" display="inline"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math> are the porosity and tortuosity of the protective film, respectively. The interpolation leads to the effective diffusion function:</p>
</div>
<div id="S2.SS2.p9" class="ltx_para">
<div id="E12" class="ltx_equation ltx_eqn_div">
<span><math id="E12.m1" class="ltx_Math" alttext="D_{\mathrm{Mg}}^{e}=D_{\mathrm{Mg}}\left(\left(1-\frac{C_{\mathrm{Film}}}{[%
\mathrm{Film}]_{\max}}\right)+\frac{C_{\mathrm{Film}}}{[\mathrm{Film}]_{\max}}%
\frac{\epsilon}{\tau}\right)." display="block"><semantics><mrow><mrow><msubsup><mi>D</mi><mi>Mg</mi><mi>e</mi></msubsup><mo>=</mo><mrow><msub><mi>D</mi><mi>Mg</mi></msub><mo>⁢</mo><mrow><mo>(</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mfrac><msub><mi>C</mi><mi>Film</mi></msub><msub><mrow><mo stretchy="false">[</mo><mi>Film</mi><mo stretchy="false">]</mo></mrow><mi>max</mi></msub></mfrac></mrow><mo>)</mo></mrow><mo>+</mo><mrow><mfrac><msub><mi>C</mi><mi>Film</mi></msub><msub><mrow><mo stretchy="false">[</mo><mi>Film</mi><mo stretchy="false">]</mo></mrow><mi>max</mi></msub></mfrac><mo>⁢</mo><mfrac><mi>ϵ</mi><mi>τ</mi></mfrac></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">D_{\mathrm{Mg}}^{e}=D_{\mathrm{Mg}}\left(\left(1-\frac{C_{\mathrm{Film}}}{[%
\mathrm{Film}]_{\max}}\right)+\frac{C_{\mathrm{Film}}}{[\mathrm{Film}]_{\max}}%
\frac{\epsilon}{\tau}\right).</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.12)</span>
              
              
            
</div>
</div>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection normal">
<div class="section level3">

<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection header-section-number">7.2.3</span> Level-set method</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p class="ltx_p">The level set method is a methodology that allows moving interfaces to be described by an implicit function. In other words, the boundaries of domains can be tracked as a function instead of being explicitly defined. In the level set method, a signed distance function, <math id="S2.SS3.p1.m1" class="ltx_Math" alttext="\phi=\phi(x,y,z,t)" display="inline"><semantics><mrow><mi>ϕ</mi><mo>=</mo><mrow><mi>ϕ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\phi=\phi(x,y,z,t)</annotation></semantics></math>, describes the distance of each point in space to the interface, and the zero iso-contour of this function implies the interface <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib41" title="Level set methods and dynamic implicit surfaces" class="ltx_ref">219</a>]</cite>. In the current study, this function was defined in a way that divides the domain into two subdomains: 1) the bulk material, in which the implicit function is positive (<math id="S2.SS3.p1.m2" class="ltx_Math" alttext="\phi&gt;0" display="inline"><semantics><mrow><mi>ϕ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\phi&gt;0</annotation></semantics></math>), and 2) the medium, in which the function is negative (<math id="S2.SS3.p1.m3" class="ltx_Math" alttext="\phi&lt;0" display="inline"><semantics><mrow><mi>ϕ</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\phi&lt;0</annotation></semantics></math>). The interface is defined as the points in space where <math id="S2.SS3.p1.m4" class="ltx_Math" alttext="\phi=0" display="inline"><semantics><mrow><mi>ϕ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\phi=0</annotation></semantics></math>. Fig. <a href="#F2" title="Figure 7.2 ‣ 7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.2</span></a> shows a schematic representation of the solid-medium interface in the current study, in which the interface moves as the material degrades over time.</p>
</div>
<figure id="F2" class="ltx_figure"><div class="bml-overflow-wrapper"><img src="chapters/hpc/image/level_set_domain.jpg" id="F2.g1" class="ltx_graphics ltx_centering" width="271" height="129" alt="A schematic representation of the implicit function definition in the current study. "></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.2: </span>A schematic representation of the implicit function definition in the current study. <math id="F2.m1" class="ltx_Math" alttext="V" display="inline"><semantics><mi>V</mi><annotation encoding="application/x-tex">V</annotation></semantics></math> denotes the shrinkage speed of the interface due to degradation.</figcaption>
</figure>
<div id="S2.SS3.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">The level set equation defines this implicit function. The full level set equation can be written as <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib41" title="Level set methods and dynamic implicit surfaces" class="ltx_ref">219</a>]</cite>:</p>
<div id="E13" class="ltx_equation ltx_eqn_div">
<span><math id="E13.m1" class="ltx_Math" alttext="\frac{\partial\phi}{\partial t}+\underbrace{\overrightarrow{V^{\mathrm{E}}}%
\cdot\nabla\phi}_{\text{External velocity field }}+\underbrace{\mathrm{V}^{%
\mathrm{N}}|\nabla\phi|}_{\text{Normal direction motion }}=\underbrace{b\kappa%
|\nabla\phi|}_{\text{Curvature - dependent term }}" display="block"><semantics><mrow><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>ϕ</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>t</mi></mrow></mfrac><mo>+</mo><munder><munder accentunder="true"><mrow><mover accent="true"><msup><mi>V</mi><mi mathvariant="normal">E</mi></msup><mo movablelimits="false">→</mo></mover><mo movablelimits="false">⋅</mo><mrow><mo movablelimits="false">∇</mo><mo movablelimits="false">⁡</mo><mi>ϕ</mi></mrow></mrow><mo movablelimits="false">⏟</mo></munder><mtext>External velocity field </mtext></munder><mo>+</mo><munder><munder accentunder="true"><mrow><msup><mi mathvariant="normal">V</mi><mi mathvariant="normal">N</mi></msup><mo movablelimits="false">⁢</mo><mrow><mo movablelimits="false" stretchy="false">|</mo><mrow><mo movablelimits="false">∇</mo><mo movablelimits="false">⁡</mo><mi>ϕ</mi></mrow><mo movablelimits="false" stretchy="false">|</mo></mrow></mrow><mo movablelimits="false">⏟</mo></munder><mtext>Normal direction motion </mtext></munder></mrow><mo>=</mo><munder><munder accentunder="true"><mrow><mi>b</mi><mo movablelimits="false">⁢</mo><mi>κ</mi><mo movablelimits="false">⁢</mo><mrow><mo movablelimits="false" stretchy="false">|</mo><mrow><mo movablelimits="false">∇</mo><mo movablelimits="false">⁡</mo><mi>ϕ</mi></mrow><mo movablelimits="false" stretchy="false">|</mo></mrow></mrow><mo movablelimits="false">⏟</mo></munder><mtext>Curvature - dependent term </mtext></munder></mrow><annotation encoding="application/x-tex">\frac{\partial\phi}{\partial t}+\underbrace{\overrightarrow{V^{\mathrm{E}}}%
\cdot\nabla\phi}_{\text{External velocity field }}+\underbrace{\mathrm{V}^{%
\mathrm{N}}|\nabla\phi|}_{\text{Normal direction motion }}=\underbrace{b\kappa%
|\nabla\phi|}_{\text{Curvature - dependent term }}</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.13)</span>
              
              
            
</div>
<p class="ltx_p">in which the terms correspond to temporal changes, external velocity field effect, normal direction motion, and curvature-dependent interface movement, respectively.
<math id="S2.SS3.p2.m1" class="ltx_Math" alttext="\overrightarrow{V^{\mathrm{E}}}" display="inline"><semantics><mover accent="true"><msup><mi>V</mi><mi mathvariant="normal">E</mi></msup><mo>→</mo></mover><annotation encoding="application/x-tex">\overrightarrow{V^{\mathrm{E}}}</annotation></semantics></math> is the external velocity field, and <math id="S2.SS3.p2.m2" class="ltx_Math" alttext="\mathrm{V}^{\mathrm{N}}" display="inline"><semantics><msup><mi mathvariant="normal">V</mi><mi mathvariant="normal">N</mi></msup><annotation encoding="application/x-tex">\mathrm{V}^{\mathrm{N}}</annotation></semantics></math> is the magnitude of the interface velocity along the normal axis. In practical usage, some of the terms are neglected. In this study, perfusion (rotation of the liquid around the bulk sample) is not considered, and the degradation rate does not depend on the curvature of the interface. As a result, by assuming that the interface moves in normal direction only, Eq. <a href="#E13" title="(7.13) ‣ 7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.13</span></a> can be simplified to</p>
<div id="E14" class="ltx_equation ltx_eqn_div">
<span><math id="E14.m1" class="ltx_Math" alttext="\frac{\partial\phi}{\partial t}+\mathrm{V}^{\mathrm{N}}|\nabla\phi|=0" display="block"><semantics><mrow><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>ϕ</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>t</mi></mrow></mfrac><mo>+</mo><mrow><msup><mi mathvariant="normal">V</mi><mi mathvariant="normal">N</mi></msup><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>ϕ</mi></mrow><mo stretchy="false">|</mo></mrow></mrow></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\frac{\partial\phi}{\partial t}+\mathrm{V}^{\mathrm{N}}|\nabla\phi|=0</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.14)</span>
              
              
            
</div>
<p class="ltx_p">where <math id="S2.SS3.p2.m3" class="ltx_Math" alttext="\mathrm{V}^{\mathrm{N}}" display="inline"><semantics><msup><mi mathvariant="normal">V</mi><mi mathvariant="normal">N</mi></msup><annotation encoding="application/x-tex">\mathrm{V}^{\mathrm{N}}</annotation></semantics></math> is depicted in Fig. <a href="#F2" title="Figure 7.2 ‣ 7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.2</span></a>. The Rankine–Hugoniot equation can be used to calculate the interface velocity in mass transfer problems <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib42" title="Stable pitting corrosion of stainless steel as diffusion-controlled dissolution process with a sharp moving electrode boundary" class="ltx_ref">230</a>]</cite>:</p>
</div>
<div id="S2.SS3.p3" class="ltx_para ltx_noindent">
<div id="E15" class="ltx_equation ltx_eqn_div">
<span><math id="E15.m1" class="ltx_Math" alttext="\left\{\mathbf{J}(x,t)-\left(c_{\mathrm{sol}}-c_{\mathrm{sat}}\right)\mathrm{V%
}(x,t)\right\}\cdot n=0" display="block"><semantics><mrow><mrow><mrow><mo>{</mo><mrow><mrow><mi>𝐉</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mo>-</mo><mrow><mrow><mo>(</mo><mrow><msub><mi>c</mi><mi>sol</mi></msub><mo>-</mo><msub><mi>c</mi><mi>sat</mi></msub></mrow><mo>)</mo></mrow><mo>⁢</mo><mi mathvariant="normal">V</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>}</mo></mrow><mo>⋅</mo><mi>n</mi></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\left\{\mathbf{J}(x,t)-\left(c_{\mathrm{sol}}-c_{\mathrm{sat}}\right)\mathrm{V%
}(x,t)\right\}\cdot n=0</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.15)</span>
              
              
            
</div>
<p class="ltx_p">in which <math id="S2.SS3.p3.m1" class="ltx_Math" alttext="\mathbf{J}" display="inline"><semantics><mi>𝐉</mi><annotation encoding="application/x-tex">\mathbf{J}</annotation></semantics></math> is the mass flux, <math id="S2.SS3.p3.m2" class="ltx_Math" alttext="c_{\mathrm{sol}}" display="inline"><semantics><msub><mi>c</mi><mi>sol</mi></msub><annotation encoding="application/x-tex">c_{\mathrm{sol}}</annotation></semantics></math> is the concentration of the material in the bulk part (i.e. its density), and <math id="S2.SS3.p3.m3" class="ltx_Math" alttext="c_{\mathrm{sat}}" display="inline"><semantics><msub><mi>c</mi><mi>sat</mi></msub><annotation encoding="application/x-tex">c_{\mathrm{sat}}</annotation></semantics></math> is the concentration at which the material (here, the ions) saturates through the medium. So, for the investigated Mg degradation problem, Eq. <a href="#E15" title="(7.15) ‣ 7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.15</span></a> will be:</p>
<div id="E16" class="ltx_equation ltx_eqn_div">
<span><math id="E16.m1" class="ltx_Math" alttext="D_{\mathrm{Mg}}^{e}\nabla_{n}C_{\mathrm{Mg}}-\left([\mathrm{Mg}]_{\mathrm{sol}%
}-[\mathrm{Mg}]_{\mathrm{sat}}\right)\mathrm{V}^{\mathrm{N}}=0." display="block"><semantics><mrow><mrow><mrow><mrow><msubsup><mi>D</mi><mi>Mg</mi><mi>e</mi></msubsup><mo>⁢</mo><mrow><msub><mo>∇</mo><mi>n</mi></msub><mo>⁡</mo><msub><mi>C</mi><mi>Mg</mi></msub></mrow></mrow><mo>-</mo><mrow><mrow><mo>(</mo><mrow><msub><mrow><mo stretchy="false">[</mo><mi>Mg</mi><mo stretchy="false">]</mo></mrow><mi>sol</mi></msub><mo>-</mo><msub><mrow><mo stretchy="false">[</mo><mi>Mg</mi><mo stretchy="false">]</mo></mrow><mi>sat</mi></msub></mrow><mo>)</mo></mrow><mo>⁢</mo><msup><mi mathvariant="normal">V</mi><mi mathvariant="normal">N</mi></msup></mrow></mrow><mo>=</mo><mn>0</mn></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">D_{\mathrm{Mg}}^{e}\nabla_{n}C_{\mathrm{Mg}}-\left([\mathrm{Mg}]_{\mathrm{sol}%
}-[\mathrm{Mg}]_{\mathrm{sat}}\right)\mathrm{V}^{\mathrm{N}}=0.</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.16)</span>
              
              
            
</div>
</div>
<div id="S2.SS3.p4" class="ltx_para">
<p class="ltx_p">Inserting the obtained velocity of Eq. <a href="#E16" title="(7.16) ‣ 7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.16</span></a> into Eq. <a href="#E14" title="(7.14) ‣ 7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.14</span></a> and considering the direction of the shrinkage velocity, which is in the opposite direction of the surface normal vector, yields</p>
<div id="E17" class="ltx_equation ltx_eqn_div">
<span><math id="E17.m1" class="ltx_Math" alttext="\frac{\partial\phi}{\partial t}-\frac{D_{\mathrm{Mg}}^{e}\nabla_{n}C_{\mathrm{%
Mg}}}{[\mathrm{Mg}]_{\mathrm{sol}}-[\mathrm{Mg}]_{\mathrm{sat}}}|\nabla\phi|=0." display="block"><semantics><mrow><mrow><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>ϕ</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>t</mi></mrow></mfrac><mo>-</mo><mrow><mfrac><mrow><msubsup><mi>D</mi><mi>Mg</mi><mi>e</mi></msubsup><mo>⁢</mo><mrow><msub><mo>∇</mo><mi>n</mi></msub><mo>⁡</mo><msub><mi>C</mi><mi>Mg</mi></msub></mrow></mrow><mrow><msub><mrow><mo stretchy="false">[</mo><mi>Mg</mi><mo stretchy="false">]</mo></mrow><mi>sol</mi></msub><mo>-</mo><msub><mrow><mo stretchy="false">[</mo><mi>Mg</mi><mo stretchy="false">]</mo></mrow><mi>sat</mi></msub></mrow></mfrac><mo>⁢</mo><mrow><mo stretchy="false">|</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>ϕ</mi></mrow><mo stretchy="false">|</mo></mrow></mrow></mrow><mo>=</mo><mn>0</mn></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\frac{\partial\phi}{\partial t}-\frac{D_{\mathrm{Mg}}^{e}\nabla_{n}C_{\mathrm{%
Mg}}}{[\mathrm{Mg}]_{\mathrm{sol}}-[\mathrm{Mg}]_{\mathrm{sat}}}|\nabla\phi|=0.</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.17)</span>
              
              
            
</div>
</div>
<div id="S2.SS3.p5" class="ltx_para">
<p class="ltx_p">Eq. <a href="#E17" title="(7.17) ‣ 7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.17</span></a> is the final formulation of the level set equation in the current study, which alongside Eqs. <a href="#E10" title="(7.10) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.10</span></a> and <a href="#E11" title="(7.11) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.11</span></a> forms the mathematical model of degradation of Mg with a moving interface. Eq. <a href="#E17" title="(7.17) ‣ 7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.17</span></a> contributes indirectly to the evolution of Eqs. <a href="#E10" title="(7.10) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.10</span></a> and <a href="#E11" title="(7.11) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.11</span></a> as it defines the boundary, the zero iso-contour of the <math id="S2.SS3.p5.m1" class="ltx_Math" alttext="\phi" display="inline"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math> function, on which the boundary conditions of the equations are applied.</p>
</div>
</div>
</section>
</div>
</section>
<section id="S3" class="ltx_section normal">
<div class="section level2">

<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section header-section-number">7.3</span> Methodology of model implementation</h2>

<div id="S3.p1" class="ltx_para">
<p class="ltx_p">The developed mathematical model comprised of Eqs. <a href="#E10" title="(7.10) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.10</span></a>, <a href="#E11" title="(7.11) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.11</span></a>, and <a href="#E17" title="(7.17) ‣ 7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.17</span></a> cannot be solved using analytical techniques. The alternative approach in these scenarios is solving the derived PDEs numerically. In this study, we used a combination of finite element and finite difference methods to solve the aforementioned equations. In the developed numerical model, the PDEs are solved one by one, each of which is a linear equation, so the model implementation follows the principles of solving linear systems. In the following section, only the process to obtain the solution of Eq. <a href="#E10" title="(7.10) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.10</span></a> is described in detail, but the other PDEs were solved using the same principle. Although the adopted finite element method is standard, we elaborate on its derivation to clarify the bottlenecks of the later-discussed implementation.</p>
</div>
<section id="S3.SS1" class="ltx_subsection normal">
<div class="section level3">

<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection header-section-number">7.3.1</span> Finite element discretization (bottleneck of the algorithm)</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p class="ltx_p">In order to solve Eq. <a href="#E10" title="(7.10) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.10</span></a> numerically, we used a finite difference scheme for the temporal term and a finite element formulation for the spatial terms. For simplicity of writing, notations of variables are changed, so <math id="S3.SS1.p1.m1" class="ltx_Math" alttext="C_{\mathrm{Mg}}" display="inline"><semantics><msub><mi>C</mi><mi>Mg</mi></msub><annotation encoding="application/x-tex">C_{\mathrm{Mg}}</annotation></semantics></math> is represented as <math id="S3.SS1.p1.m2" class="ltx_Math" alttext="u" display="inline"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math> (the main unknown state variable to find), <math id="S3.SS1.p1.m3" class="ltx_Math" alttext="C_{\mathrm{Film}}" display="inline"><semantics><msub><mi>C</mi><mi>Film</mi></msub><annotation encoding="application/x-tex">C_{\mathrm{Film}}</annotation></semantics></math> is denoted by <math id="S3.SS1.p1.m4" class="ltx_Math" alttext="p" display="inline"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>, <math id="S3.SS1.p1.m5" class="ltx_Math" alttext="[\mathrm{Cl}]" display="inline"><semantics><mrow><mo stretchy="false">[</mo><mi>Cl</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mathrm{Cl}]</annotation></semantics></math> is denoted by <math id="S3.SS1.p1.m6" class="ltx_Math" alttext="q" display="inline"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>, and the saturation term <math id="S3.SS1.p1.m7" class="ltx_Math" alttext="(1-\frac{F}{F_{\max}})" display="inline"><semantics><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>-</mo><mfrac><mi>F</mi><msub><mi>F</mi><mi>max</mi></msub></mfrac></mrow><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1-\frac{F}{F_{\max}})</annotation></semantics></math> is denoted by <math id="S3.SS1.p1.m8" class="ltx_Math" alttext="s" display="inline"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>. By doing this, Eq. <a href="#E10" title="(7.10) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.10</span></a> can be written as</p>
<div id="E18" class="ltx_equation ltx_eqn_div">
<span><math id="E18.m1" class="ltx_Math" alttext="\frac{\partial u}{\partial t}=\nabla\cdot(D\nabla u)-k_{1}su+k_{2}pq^{2}." display="block"><semantics><mrow><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mrow><mrow><mrow><mo>∇</mo><mo>⋅</mo><mrow><mo stretchy="false">(</mo><mrow><mi>D</mi><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>u</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>-</mo><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>⁢</mo><mi>s</mi><mo>⁢</mo><mi>u</mi></mrow></mrow><mo>+</mo><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>⁢</mo><mi>p</mi><mo>⁢</mo><msup><mi>q</mi><mn>2</mn></msup></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\frac{\partial u}{\partial t}=\nabla\cdot(D\nabla u)-k_{1}su+k_{2}pq^{2}.</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.18)</span>
              
              
            
</div>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p class="ltx_p">To obtain the finite element formulation, the weak form of derived PDE is required. In order to get this, we define a space of test functions and then, multiply each term of the PDE by any arbitrary function as a member of this space. The test function space is</p>
<div id="E19" class="ltx_equation ltx_eqn_div">
<span><math id="E19.m1" class="ltx_Math" alttext="\mathcal{V}=\left\{v(\mathbf{x})|\mathbf{x}\in{\Omega},v(\mathbf{x})\in%
\mathcal{H}^{1}(\Omega),\text{ and }v(\mathbf{x})=0\text{ on }\Gamma\right\}" display="block"><semantics><mrow><mi class="ltx_font_mathcaligraphic">𝒱</mi><mo>=</mo><mrow><mo>{</mo><mrow><mi>v</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐱</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">|</mo><mrow><mrow><mi>𝐱</mi><mo>∈</mo><mi mathvariant="normal">Ω</mi></mrow><mo>,</mo><mrow><mrow><mrow><mi>v</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐱</mi><mo stretchy="false">)</mo></mrow></mrow><mo>∈</mo><mrow><msup><mi class="ltx_font_mathcaligraphic">ℋ</mi><mn>1</mn></msup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo><mrow><mrow><mtext> and </mtext><mo>⁢</mo><mi>v</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐱</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mn>0</mn><mo>⁢</mo><mtext> on </mtext><mo>⁢</mo><mi mathvariant="normal">Γ</mi></mrow></mrow></mrow></mrow><mo>}</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{V}=\left\{v(\mathbf{x})|\mathbf{x}\in{\Omega},v(\mathbf{x})\in%
\mathcal{H}^{1}(\Omega),\text{ and }v(\mathbf{x})=0\text{ on }\Gamma\right\}</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.19)</span>
              
              
            
</div>
<p class="ltx_p">in which the <math id="S3.SS1.p2.m1" class="ltx_Math" alttext="\Omega" display="inline"><semantics><mi mathvariant="normal">Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math> is the domain of interest, <math id="S3.SS1.p2.m2" class="ltx_Math" alttext="\Gamma" display="inline"><semantics><mi mathvariant="normal">Γ</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math> is the boundary of <math id="S3.SS1.p2.m3" class="ltx_Math" alttext="\Omega" display="inline"><semantics><mi mathvariant="normal">Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>, and <math id="S3.SS1.p2.m4" class="ltx_Math" alttext="\mathcal{H}^{1}" display="inline"><semantics><msup><mi class="ltx_font_mathcaligraphic">ℋ</mi><mn>1</mn></msup><annotation encoding="application/x-tex">\mathcal{H}^{1}</annotation></semantics></math> denotes the Sobolev space of the domain <math id="S3.SS1.p2.m5" class="ltx_Math" alttext="\Omega" display="inline"><semantics><mi mathvariant="normal">Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>, which is a space of functions whose derivatives are square-integrable functions in <math id="S3.SS1.p2.m6" class="ltx_Math" alttext="\Omega" display="inline"><semantics><mi mathvariant="normal">Ω</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>. The solution of the PDE belongs to a trial function space, which is similarly defined as</p>
<div id="E20" class="ltx_equation ltx_eqn_div">
<span><math id="E20.m1" class="ltx_Math" alttext="\mathcal{S}_{t}=\left\{u(\mathbf{x},t)|\mathbf{x}\in\Omega,t&gt;0,u(\mathbf{x},t)%
\in\mathcal{H}^{1}(\Omega),\text{ and }\frac{\partial u}{\partial n}=0\text{ %
on }\Gamma\right\}." display="block"><semantics><mrow><mrow><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>t</mi></msub><mo>=</mo><mrow><mo>{</mo><mrow><mi>u</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐱</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">|</mo><mrow><mrow><mi>𝐱</mi><mo>∈</mo><mi mathvariant="normal">Ω</mi></mrow><mo>,</mo><mrow><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><mo>,</mo><mrow><mrow><mrow><mi>u</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐱</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mo>∈</mo><mrow><msup><mi class="ltx_font_mathcaligraphic">ℋ</mi><mn>1</mn></msup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi mathvariant="normal">Ω</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo><mrow><mrow><mtext> and </mtext><mo>⁢</mo><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>n</mi></mrow></mfrac></mrow><mo>=</mo><mrow><mn>0</mn><mo>⁢</mo><mtext> on </mtext><mo>⁢</mo><mi mathvariant="normal">Γ</mi></mrow></mrow></mrow></mrow></mrow><mo>}</mo></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\mathcal{S}_{t}=\left\{u(\mathbf{x},t)|\mathbf{x}\in\Omega,t&gt;0,u(\mathbf{x},t)%
\in\mathcal{H}^{1}(\Omega),\text{ and }\frac{\partial u}{\partial n}=0\text{ %
on }\Gamma\right\}.</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.20)</span>
              
              
            
</div>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p class="ltx_p">Then, we multiply Eq. <a href="#E18" title="(7.18) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.18</span></a> to an arbitrary function <math id="S3.SS1.p3.m1" class="ltx_Math" alttext="v\in\mathcal{V}" display="inline"><semantics><mrow><mi>v</mi><mo>∈</mo><mi class="ltx_font_mathcaligraphic">𝒱</mi></mrow><annotation encoding="application/x-tex">v\in\mathcal{V}</annotation></semantics></math>:</p>
<div id="E21" class="ltx_equation ltx_eqn_div">
<span><math id="E21.m1" class="ltx_Math" alttext="\frac{\partial u}{\partial t}v=\nabla\cdot(D\nabla u)v-k_{1}suv+k_{2}pq^{2}v." display="block"><semantics><mrow><mrow><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>t</mi></mrow></mfrac><mo>⁢</mo><mi>v</mi></mrow><mo>=</mo><mrow><mrow><mrow><mrow><mo>∇</mo><mo>⋅</mo><mrow><mo stretchy="false">(</mo><mrow><mi>D</mi><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>u</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>⁢</mo><mi>v</mi></mrow><mo>-</mo><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>⁢</mo><mi>s</mi><mo>⁢</mo><mi>u</mi><mo>⁢</mo><mi>v</mi></mrow></mrow><mo>+</mo><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>⁢</mo><mi>p</mi><mo>⁢</mo><msup><mi>q</mi><mn>2</mn></msup><mo>⁢</mo><mi>v</mi></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\frac{\partial u}{\partial t}v=\nabla\cdot(D\nabla u)v-k_{1}suv+k_{2}pq^{2}v.</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.21)</span>
              
              
            
</div>
</div>
<div id="S3.SS1.p4" class="ltx_para ltx_noindent">
<p class="ltx_p">Integrating over the whole domain yields:</p>
<div id="E22" class="ltx_equation ltx_eqn_div">
<span><math id="E22.m1" class="ltx_Math" alttext="\int_{\Omega}\frac{\partial u}{\partial t}vd\omega=\int_{\Omega}\nabla\cdot(D%
\nabla u)vd\omega-\int_{\Omega}k_{1}suvd\omega+\int_{\Omega}k_{2}pq^{2}vd\omega." display="block"><semantics><mrow><mrow><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>t</mi></mrow></mfrac><mo>⁢</mo><mi>v</mi><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>ω</mi></mrow></mrow></mrow><mo>=</mo><mrow><mrow><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><mrow><mo>∇</mo><mo>⋅</mo><mrow><mo stretchy="false">(</mo><mrow><mi>D</mi><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>u</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>⁢</mo><mi>v</mi><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>ω</mi></mrow></mrow></mrow><mo>-</mo><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>⁢</mo><mi>s</mi><mo>⁢</mo><mi>u</mi><mo>⁢</mo><mi>v</mi><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>ω</mi></mrow></mrow></mrow></mrow><mo>+</mo><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>⁢</mo><mi>p</mi><mo>⁢</mo><msup><mi>q</mi><mn>2</mn></msup><mo>⁢</mo><mi>v</mi><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>ω</mi></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\int_{\Omega}\frac{\partial u}{\partial t}vd\omega=\int_{\Omega}\nabla\cdot(D%
\nabla u)vd\omega-\int_{\Omega}k_{1}suvd\omega+\int_{\Omega}k_{2}pq^{2}vd\omega.</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.22)</span>
              
              
            
</div>
</div>
<div id="S3.SS1.p5" class="ltx_para ltx_noindent">
<p class="ltx_p">The diffusion term can be split using the integration by parts technique:</p>
<div id="E23" class="ltx_equation ltx_eqn_div">
<span><math id="E23.m1" class="ltx_Math" alttext="\int_{\Omega}\nabla\cdot(D\nabla u)vd\omega=\int_{\Omega}\nabla\cdot[v(D\nabla
u%
)]d\omega-\int_{\Omega}(\nabla v)\cdot(D\nabla u)d\omega" display="block"><semantics><mrow><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><mrow><mo>∇</mo><mo>⋅</mo><mrow><mo stretchy="false">(</mo><mrow><mi>D</mi><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>u</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>⁢</mo><mi>v</mi><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>ω</mi></mrow></mrow></mrow><mo>=</mo><mrow><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><mrow><mo>∇</mo><mo>⋅</mo><mrow><mo stretchy="false">[</mo><mrow><mi>v</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>D</mi><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>u</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>ω</mi></mrow></mrow></mrow><mo>-</mo><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>v</mi></mrow><mo stretchy="false">)</mo></mrow><mo>⋅</mo><mrow><mo stretchy="false">(</mo><mrow><mi>D</mi><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>u</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>ω</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\int_{\Omega}\nabla\cdot(D\nabla u)vd\omega=\int_{\Omega}\nabla\cdot[v(D\nabla
u%
)]d\omega-\int_{\Omega}(\nabla v)\cdot(D\nabla u)d\omega</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.23)</span>
              
              
            
</div>
</div>
<div id="S3.SS1.p6" class="ltx_para ltx_noindent">
<p class="ltx_p">in which the second term can be converted to a surface integral on the domain boundary by applying the Green’s divergence theory:</p>
<div id="E24" class="ltx_equation ltx_eqn_div">
<span><math id="E24.m1" class="ltx_Math" alttext="\int_{\Omega}\nabla\cdot[v(D\nabla u)]d\omega=\int_{\Gamma}Dv\frac{\partial u}%
{\partial n}d\gamma." display="block"><semantics><mrow><mrow><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><mrow><mo>∇</mo><mo>⋅</mo><mrow><mo stretchy="false">[</mo><mrow><mi>v</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>D</mi><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>u</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>ω</mi></mrow></mrow></mrow><mo>=</mo><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Γ</mi></msub><mrow><mi>D</mi><mo>⁢</mo><mi>v</mi><mo>⁢</mo><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>n</mi></mrow></mfrac><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>γ</mi></mrow></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\int_{\Omega}\nabla\cdot[v(D\nabla u)]d\omega=\int_{\Gamma}Dv\frac{\partial u}%
{\partial n}d\gamma.</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.24)</span>
              
              
            
</div>
</div>
<div id="S3.SS1.p7" class="ltx_para ltx_noindent">
<p class="ltx_p">For the temporal term, we use the finite difference method and apply a first-order backward Euler scheme for discretization, which makes it possible to solve the PDE implicitly:</p>
<div id="E25" class="ltx_equation ltx_eqn_div">
<span><math id="E25.m1" class="ltx_Math" alttext="\frac{\partial u}{\partial t}=\frac{u-u^{n}}{\Delta t}" display="block"><semantics><mrow><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>u</mi><mo>-</mo><msup><mi>u</mi><mi>n</mi></msup></mrow><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial u}{\partial t}=\frac{u-u^{n}}{\Delta t}</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.25)</span>
              
              
            
</div>
<p class="ltx_p">where <math id="S3.SS1.p7.m1" class="ltx_Math" alttext="u^{n}" display="inline"><semantics><msup><mi>u</mi><mi>n</mi></msup><annotation encoding="application/x-tex">u^{n}</annotation></semantics></math> denotes the value of the state variable in the previous time step (or initial condition for the first time step). Inserting Eqs. <a href="#E23" title="(7.23) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.23</span></a>, <a href="#E24" title="(7.24) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.24</span></a>, and <a href="#E25" title="(7.25) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.25</span></a> into Eq. <a href="#E22" title="(7.22) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.22</span></a> yields:</p>
<div id="E26" class="ltx_equation ltx_eqn_div">
<span><math id="E26.m1" class="ltx_Math" alttext="\int_{\Omega}\frac{u-u^{n}}{\Delta t}vd\omega=\int_{\Gamma}Dv\frac{\partial u}%
{\partial n}d\gamma-\int_{\Omega}D\nabla u\cdot\nabla vd\omega-\int_{\Omega}k_%
{1}suvd\omega+\int_{\Omega}k_{2}pq^{2}vd\omega." display="block"><semantics><mrow><mrow><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><mfrac><mrow><mi>u</mi><mo>-</mo><msup><mi>u</mi><mi>n</mi></msup></mrow><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi></mrow></mfrac><mo>⁢</mo><mi>v</mi><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>ω</mi></mrow></mrow></mrow><mo>=</mo><mrow><mrow><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Γ</mi></msub><mrow><mi>D</mi><mo>⁢</mo><mi>v</mi><mo>⁢</mo><mfrac><mrow><mo>∂</mo><mo>⁡</mo><mi>u</mi></mrow><mrow><mo>∂</mo><mo>⁡</mo><mi>n</mi></mrow></mfrac><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>γ</mi></mrow></mrow></mrow><mo>-</mo><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><mrow><mi>D</mi><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>u</mi></mrow></mrow><mo>⋅</mo><mrow><mo>∇</mo><mo>⁡</mo><mrow><mi>v</mi><mo>⁢</mo><mi>d</mi><mo>⁢</mo><mi>ω</mi></mrow></mrow></mrow></mrow><mo>-</mo><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>⁢</mo><mi>s</mi><mo>⁢</mo><mi>u</mi><mo>⁢</mo><mi>v</mi><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>ω</mi></mrow></mrow></mrow></mrow><mo>+</mo><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>⁢</mo><mi>p</mi><mo>⁢</mo><msup><mi>q</mi><mn>2</mn></msup><mo>⁢</mo><mi>v</mi><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>ω</mi></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\int_{\Omega}\frac{u-u^{n}}{\Delta t}vd\omega=\int_{\Gamma}Dv\frac{\partial u}%
{\partial n}d\gamma-\int_{\Omega}D\nabla u\cdot\nabla vd\omega-\int_{\Omega}k_%
{1}suvd\omega+\int_{\Omega}k_{2}pq^{2}vd\omega.</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.26)</span>
              
              
            
</div>
</div>
<div id="S3.SS1.p8" class="ltx_para ltx_noindent">
<p class="ltx_p">The surface integral is zero because there is a no-flux boundary condition on the boundary of the computational domain (defined in the trial function space according to Eq. <a href="#E20" title="(7.20) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.20</span></a>). By reordering the equation, we get the weak form of Eq. <a href="#E18" title="(7.18) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.18</span></a>:</p>
<div id="E27" class="ltx_equation ltx_eqn_div">
<span><math id="E27.m1" class="ltx_Math" alttext="\int_{\Omega}{u}vd\omega+\int_{\Omega}\Delta tD\nabla u\cdot\nabla vd\omega+%
\int_{\Omega}\Delta tk_{1}suvd\omega=\int_{\Omega}{u^{n}}vd\omega+\int_{\Omega%
}\Delta tk_{2}pq^{2}vd\omega." display="block"><semantics><mrow><mrow><mrow><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><mi>u</mi><mo>⁢</mo><mi>v</mi><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>ω</mi></mrow></mrow></mrow><mo>+</mo><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mi>D</mi><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>u</mi></mrow></mrow><mo>⋅</mo><mrow><mo>∇</mo><mo>⁡</mo><mrow><mi>v</mi><mo>⁢</mo><mi>d</mi><mo>⁢</mo><mi>ω</mi></mrow></mrow></mrow></mrow><mo>+</mo><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><msub><mi>k</mi><mn>1</mn></msub><mo>⁢</mo><mi>s</mi><mo>⁢</mo><mi>u</mi><mo>⁢</mo><mi>v</mi><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>ω</mi></mrow></mrow></mrow></mrow><mo>=</mo><mrow><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><msup><mi>u</mi><mi>n</mi></msup><mo>⁢</mo><mi>v</mi><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>ω</mi></mrow></mrow></mrow><mo>+</mo><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><msub><mi>k</mi><mn>2</mn></msub><mo>⁢</mo><mi>p</mi><mo>⁢</mo><msup><mi>q</mi><mn>2</mn></msup><mo>⁢</mo><mi>v</mi><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>ω</mi></mrow></mrow></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\int_{\Omega}{u}vd\omega+\int_{\Omega}\Delta tD\nabla u\cdot\nabla vd\omega+%
\int_{\Omega}\Delta tk_{1}suvd\omega=\int_{\Omega}{u^{n}}vd\omega+\int_{\Omega%
}\Delta tk_{2}pq^{2}vd\omega.</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.27)</span>
              
              
            
</div>
</div>
<div id="S3.SS1.p9" class="ltx_para ltx_noindent">
<p class="ltx_p">So, the problem is finding a function <math id="S3.SS1.p9.m1" class="ltx_Math" alttext="u(t)\in\mathcal{S}_{t}" display="inline"><semantics><mrow><mrow><mi>u</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mo>∈</mo><msub><mi class="ltx_font_mathcaligraphic">𝒮</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">u(t)\in\mathcal{S}_{t}</annotation></semantics></math> such that for all <math id="S3.SS1.p9.m2" class="ltx_Math" alttext="v\in\mathcal{V}" display="inline"><semantics><mrow><mi>v</mi><mo>∈</mo><mi class="ltx_font_mathcaligraphic">𝒱</mi></mrow><annotation encoding="application/x-tex">v\in\mathcal{V}</annotation></semantics></math> Eq. <a href="#E27" title="(7.27) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.27</span></a> would be satisfied. By defining a linear functional <math id="S3.SS1.p9.m3" class="ltx_Math" alttext="(f,v)=\int_{\Omega}fvd\omega" display="inline"><semantics><mrow><mrow><mo stretchy="false">(</mo><mi>f</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><mo>=</mo><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mi mathvariant="normal">Ω</mi></msub><mrow><mi>f</mi><mo>⁢</mo><mi>v</mi><mo>⁢</mo><mrow><mo rspace="0pt">𝑑</mo><mi>ω</mi></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">(f,v)=\int_{\Omega}fvd\omega</annotation></semantics></math> and encapsulating the independent concentration terms into <math id="S3.SS1.p9.m4" class="ltx_Math" alttext="f^{n}=pq^{2}" display="inline"><semantics><mrow><msup><mi>f</mi><mi>n</mi></msup><mo>=</mo><mrow><mi>p</mi><mo>⁢</mo><msup><mi>q</mi><mn>2</mn></msup></mrow></mrow><annotation encoding="application/x-tex">f^{n}=pq^{2}</annotation></semantics></math>, Eq. <a href="#E27" title="(7.27) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.27</span></a> can be simplified as:</p>
<div id="E28" class="ltx_equation ltx_eqn_div">
<span><math id="E28.m1" class="ltx_Math" alttext="(u,v)[1+\Delta tk_{1}s]+\Delta t(D\nabla u,\nabla v)=\left(u^{n},v\right)+%
\Delta t\left(f^{n},v\right)" display="block"><semantics><mrow><mrow><mrow><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mn>1</mn><mo>+</mo><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><msub><mi>k</mi><mn>1</mn></msub><mo>⁢</mo><mi>s</mi></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>+</mo><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>D</mi><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>u</mi></mrow></mrow><mo>,</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>v</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mrow><mo>(</mo><msup><mi>u</mi><mi>n</mi></msup><mo>,</mo><mi>v</mi><mo>)</mo></mrow><mo>+</mo><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo>(</mo><msup><mi>f</mi><mi>n</mi></msup><mo>,</mo><mi>v</mi><mo>)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">(u,v)[1+\Delta tk_{1}s]+\Delta t(D\nabla u,\nabla v)=\left(u^{n},v\right)+%
\Delta t\left(f^{n},v\right)</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.28)</span>
              
              
            
</div>
<p class="ltx_p">which can be further converted to the common form of the weak formulation of time-dependent reaction-diffusion PDEs by multiplying to a new coefficient <math id="S3.SS1.p9.m5" class="ltx_Math" alttext="\alpha=\frac{1}{1+\Delta tk_{1}s}" display="inline"><semantics><mrow><mi>α</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mrow><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><msub><mi>k</mi><mn>1</mn></msub><mo>⁢</mo><mi>s</mi></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\alpha=\frac{1}{1+\Delta tk_{1}s}</annotation></semantics></math>:</p>
</div>
<div id="S3.SS1.p10" class="ltx_para">
<div id="E29" class="ltx_equation ltx_eqn_div">
<span><math id="E29.m1" class="ltx_Math" alttext="(u,v)+\alpha\Delta t(D\nabla u,\nabla v)=\alpha\left(u^{n},v\right)+\alpha%
\Delta t\left(f^{n},v\right)." display="block"><semantics><mrow><mrow><mrow><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><mo>+</mo><mrow><mi>α</mi><mo>⁢</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>D</mi><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>u</mi></mrow></mrow><mo>,</mo><mrow><mo>∇</mo><mo>⁡</mo><mi>v</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mrow><mi>α</mi><mo>⁢</mo><mrow><mo>(</mo><msup><mi>u</mi><mi>n</mi></msup><mo>,</mo><mi>v</mi><mo>)</mo></mrow></mrow><mo>+</mo><mrow><mi>α</mi><mo>⁢</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo>(</mo><msup><mi>f</mi><mi>n</mi></msup><mo>,</mo><mi>v</mi><mo>)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">(u,v)+\alpha\Delta t(D\nabla u,\nabla v)=\alpha\left(u^{n},v\right)+\alpha%
\Delta t\left(f^{n},v\right).</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.29)</span>
              
              
            
</div>
</div>
<div id="S3.SS1.p11" class="ltx_para">
<p class="ltx_p">One can approximate the unknown function <math id="S3.SS1.p11.m1" class="ltx_Math" alttext="u" display="inline"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math> in Eq. <a href="#E29" title="(7.29) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.29</span></a> by <math id="S3.SS1.p11.m2" class="ltx_Math" alttext="u(x)\approx\sum_{i=0}^{N}c_{i}\psi_{i}(x)" display="inline"><semantics><mrow><mrow><mi>u</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>≈</mo><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></msubsup><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>⁢</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">u(x)\approx\sum_{i=0}^{N}c_{i}\psi_{i}(x)</annotation></semantics></math>, where the <math id="S3.SS1.p11.m3" class="ltx_Math" alttext="\psi_{i}" display="inline"><semantics><msub><mi>ψ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\psi_{i}</annotation></semantics></math> are the basis functions used to discretize the function space, and <math id="S3.SS1.p11.m4" class="ltx_Math" alttext="c_{0},\ldots,c_{N}" display="inline"><semantics><mrow><msub><mi>c</mi><mn>0</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>c</mi><mi>N</mi></msub></mrow><annotation encoding="application/x-tex">c_{0},\ldots,c_{N}</annotation></semantics></math> are the unknown coefficients. The finite element method uses Lagrange polynomials as the basis function and discretizes the computational domain using a new function space <math id="S3.SS1.p11.m5" class="ltx_Math" alttext="\mathcal{V}_{h}" display="inline"><semantics><msub><mi class="ltx_font_mathcaligraphic">𝒱</mi><mi>h</mi></msub><annotation encoding="application/x-tex">\mathcal{V}_{h}</annotation></semantics></math> spanned by the basis functions <math id="S3.SS1.p11.m6" class="ltx_Math" alttext="\left\{\psi_{i}\right\}_{i\in\mathcal{I}_{s}}" display="inline"><semantics><msub><mrow><mo>{</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo>}</mo></mrow><mrow><mi>i</mi><mo>∈</mo><msub><mi class="ltx_font_mathcaligraphic">ℐ</mi><mi>s</mi></msub></mrow></msub><annotation encoding="application/x-tex">\left\{\psi_{i}\right\}_{i\in\mathcal{I}_{s}}</annotation></semantics></math>, in which <math id="S3.SS1.p11.m7" class="ltx_Math" alttext="\mathcal{I}_{s}" display="inline"><semantics><msub><mi class="ltx_font_mathcaligraphic">ℐ</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\mathcal{I}_{s}</annotation></semantics></math> is defined as <math id="S3.SS1.p11.m8" class="ltx_Math" alttext="\mathcal{I}_{s}=\{0,\ldots,N\}" display="inline"><semantics><mrow><msub><mi class="ltx_font_mathcaligraphic">ℐ</mi><mi>s</mi></msub><mo>=</mo><mrow><mo stretchy="false">{</mo><mn>0</mn><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><mi>N</mi><mo stretchy="false">}</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{I}_{s}=\{0,\ldots,N\}</annotation></semantics></math>, where <math id="S3.SS1.p11.m9" class="ltx_Math" alttext="N" display="inline"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math> denotes the degrees of freedom in the computational mesh. The computational mesh discretizes the space into a finite number of elements, in each of which the <math id="S3.SS1.p11.m10" class="ltx_Math" alttext="\psi_{i}" display="inline"><semantics><msub><mi>ψ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\psi_{i}</annotation></semantics></math> is non-zero inside the <math id="S3.SS1.p11.m11" class="ltx_Math" alttext="i" display="inline"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>th element and zero everywhere else. In this study, 1st order Lagrange polynomials were used as the basis functions to define the finite element space.</p>
</div>
<div id="S3.SS1.p12" class="ltx_para">
<p class="ltx_p">For 1D elements, a 1st order Lagrange polynomial for the <math id="S3.SS1.p12.m1" class="ltx_Math" alttext="i" display="inline"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>th element with the width of <math id="S3.SS1.p12.m2" class="ltx_Math" alttext="h" display="inline"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math> can be written as:</p>
<div id="E30" class="ltx_equation ltx_eqn_div">
<span><math id="E30.m1" class="ltx_Math" alttext="\psi_{i}(x)=\left\{\begin{array}[]{cc}{0}&{\quad x<x_{i-1}}\\
{\left(x-x_{i-1}\right)/h}&{\quad x_{i-1}\leq x&lt;x_{i}}\\
{1-\left(x-x_{i}\right)/h}&{\quad x_{i}\leq x&lt;x_{i+1}}\\
{0}&{\quad x\geq x_{i+1}}\end{array}\right.." display="block"><semantics><mrow><mrow><mrow><msub><mi>ψ</mi><mi>i</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mpadded lspace="10pt" width="+10pt"><mi>x</mi></mpadded><mo>&lt;</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd columnalign="center"><mrow><mrow><mo>(</mo><mrow><mi>x</mi><mo>-</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>)</mo></mrow><mo>/</mo><mi>h</mi></mrow></mtd><mtd columnalign="center"><mrow><msub><mpadded lspace="10pt" width="+10pt"><mi>x</mi></mpadded><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>≤</mo><mi>x</mi><mo>&lt;</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></mtd></mtr><mtr><mtd columnalign="center"><mrow><mn>1</mn><mo>-</mo><mrow><mrow><mo>(</mo><mrow><mi>x</mi><mo>-</mo><msub><mi>x</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>/</mo><mi>h</mi></mrow></mrow></mtd><mtd columnalign="center"><mrow><msub><mpadded lspace="10pt" width="+10pt"><mi>x</mi></mpadded><mi>i</mi></msub><mo>≤</mo><mi>x</mi><mo>&lt;</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd columnalign="center"><mn>0</mn></mtd><mtd columnalign="center"><mrow><mpadded lspace="10pt" width="+10pt"><mi>x</mi></mpadded><mo>≥</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mtd></mtr></mtable><mi></mi></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\psi_{i}(x)=\left\{\begin{array}[]{cc}{0}&amp;{\quad x&lt;x_{i-1}}\\
{\left(x-x_{i-1}\right)/h}&amp;{\quad x_{i-1}\leq x&lt;x_{i}}\\
{1-\left(x-x_{i}\right)/h}&amp;{\quad x_{i}\leq x&lt;x_{i+1}}\\
{0}&amp;{\quad x\geq x_{i+1}}\end{array}\right..</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.30)</span>
              
              
            
</div>
</div>
<div id="S3.SS1.p13" class="ltx_para">
<p class="ltx_p">A similar approach can be applied to define the basis function space in 2D and 3D spaces.</p>
</div>
<div id="S3.SS1.p14" class="ltx_para ltx_noindent">
<p class="ltx_p">In order to derive a linear system of equations for obtaining the unknown coefficients <math id="S3.SS1.p14.m1" class="ltx_Math" alttext="c_{j}" display="inline"><semantics><msub><mi>c</mi><mi>j</mi></msub><annotation encoding="application/x-tex">c_{j}</annotation></semantics></math>, we define</p>
<div id="E31" class="ltx_equation ltx_eqn_div">
<span><math id="E31.m1" class="ltx_Math" alttext="u=\sum_{j=0}^{N}c_{j}\psi_{j}(\boldsymbol{x}),\quad u^{n}=\sum_{j=0}^{N}c_{j}^%
{n}\psi_{j}(\boldsymbol{x})" display="block"><semantics><mrow><mrow><mi>u</mi><mo>=</mo><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></munderover><mrow><msub><mi>c</mi><mi>j</mi></msub><mo>⁢</mo><msub><mi>ψ</mi><mi>j</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝒙</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo rspace="12.5pt">,</mo><mrow><msup><mi>u</mi><mi>n</mi></msup><mo>=</mo><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></munderover><mrow><msubsup><mi>c</mi><mi>j</mi><mi>n</mi></msubsup><mo>⁢</mo><msub><mi>ψ</mi><mi>j</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝒙</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">u=\sum_{j=0}^{N}c_{j}\psi_{j}(\boldsymbol{x}),\quad u^{n}=\sum_{j=0}^{N}c_{j}^%
{n}\psi_{j}(\boldsymbol{x})</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.31)</span>
              
              
            
</div>
<p class="ltx_p">as the definition of the unknown function <math id="S3.SS1.p14.m2" class="ltx_Math" alttext="u" display="inline"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math> and its value in the previous time step <math id="S3.SS1.p14.m3" class="ltx_Math" alttext="u^{n}" display="inline"><semantics><msup><mi>u</mi><mi>n</mi></msup><annotation encoding="application/x-tex">u^{n}</annotation></semantics></math>. We then insert it into Eq. <a href="#E29" title="(7.29) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.29</span></a>, which yields the following equation for each degree of freedom <math id="S3.SS1.p14.m4" class="ltx_Math" alttext="i=0,\ldots,N" display="inline"><semantics><mrow><mi>i</mi><mo>=</mo><mrow><mn>0</mn><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><mi>N</mi></mrow></mrow><annotation encoding="application/x-tex">i=0,\ldots,N</annotation></semantics></math>, where the test functions are selected as <math id="S3.SS1.p14.m5" class="ltx_Math" alttext="v=\psi_{i}" display="inline"><semantics><mrow><mi>v</mi><mo>=</mo><msub><mi>ψ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v=\psi_{i}</annotation></semantics></math>:</p>
<div id="E32" class="ltx_equation ltx_eqn_div">
<span><math id="E32.m1" class="ltx_Math" alttext="\sum_{j=0}^{N}\left(\psi_{i},\psi_{j}\right)c_{j}+\alpha\Delta t\sum_{j=0}^{N}%
\left(\nabla\psi_{i},D\nabla\psi_{j}\right)c_{j}=\sum_{j=0}^{N}\alpha\left(%
\psi_{i},\psi_{j}\right)c_{j}^{n}+\alpha\Delta t\left(f^{n},\psi_{i}\right)." display="block"><semantics><mrow><mrow><mrow><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></munderover><mrow><mrow><mo>(</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ψ</mi><mi>j</mi></msub><mo>)</mo></mrow><mo>⁢</mo><msub><mi>c</mi><mi>j</mi></msub></mrow></mrow><mo>+</mo><mrow><mi>α</mi><mo>⁢</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></munderover><mrow><mrow><mo>(</mo><mrow><mo>∇</mo><mo>⁡</mo><msub><mi>ψ</mi><mi>i</mi></msub></mrow><mo>,</mo><mrow><mi>D</mi><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><msub><mi>ψ</mi><mi>j</mi></msub></mrow></mrow><mo>)</mo></mrow><mo>⁢</mo><msub><mi>c</mi><mi>j</mi></msub></mrow></mrow></mrow></mrow><mo>=</mo><mrow><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></munderover><mrow><mi>α</mi><mo>⁢</mo><mrow><mo>(</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ψ</mi><mi>j</mi></msub><mo>)</mo></mrow><mo>⁢</mo><msubsup><mi>c</mi><mi>j</mi><mi>n</mi></msubsup></mrow></mrow><mo>+</mo><mrow><mi>α</mi><mo>⁢</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo>(</mo><msup><mi>f</mi><mi>n</mi></msup><mo>,</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo>)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\sum_{j=0}^{N}\left(\psi_{i},\psi_{j}\right)c_{j}+\alpha\Delta t\sum_{j=0}^{N}%
\left(\nabla\psi_{i},D\nabla\psi_{j}\right)c_{j}=\sum_{j=0}^{N}\alpha\left(%
\psi_{i},\psi_{j}\right)c_{j}^{n}+\alpha\Delta t\left(f^{n},\psi_{i}\right).</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.32)</span>
              
              
            
</div>
</div>
<div id="S3.SS1.p15" class="ltx_para">
<p class="ltx_p">Eq. <a href="#E32" title="(7.32) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.32</span></a> is a linear system:</p>
<div id="E33" class="ltx_equation ltx_eqn_div">
<span><math id="E33.m1" class="ltx_Math" alttext="\sum_{j}A_{i,j}c_{j}=b_{i}," display="block"><semantics><mrow><mrow><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mi>j</mi></munder><mrow><msub><mi>A</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>⁢</mo><msub><mi>c</mi><mi>j</mi></msub></mrow></mrow><mo>=</mo><msub><mi>b</mi><mi>i</mi></msub></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\sum_{j}A_{i,j}c_{j}=b_{i},</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.33)</span>
              
              
            
</div>
<p class="ltx_p">with</p>
<div id="E34" class="ltx_equation ltx_eqn_div">
<span><math id="E34.m1" class="ltx_Math" alttext="A_{i,j}=\left(\psi_{i},\psi_{j}\right)+\alpha\Delta t\left(\nabla\psi_{i},D%
\nabla\psi_{j}\right)" display="block"><semantics><mrow><msub><mi>A</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><mrow><mo>(</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ψ</mi><mi>j</mi></msub><mo>)</mo></mrow><mo>+</mo><mrow><mi>α</mi><mo>⁢</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo>(</mo><mrow><mo>∇</mo><mo>⁡</mo><msub><mi>ψ</mi><mi>i</mi></msub></mrow><mo>,</mo><mrow><mi>D</mi><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><msub><mi>ψ</mi><mi>j</mi></msub></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">A_{i,j}=\left(\psi_{i},\psi_{j}\right)+\alpha\Delta t\left(\nabla\psi_{i},D%
\nabla\psi_{j}\right)</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.34)</span>
              
              
            
</div>
<div id="E35" class="ltx_equation ltx_eqn_div">
<span><math id="E35.m1" class="ltx_Math" alttext="b_{i}=\sum_{j=0}^{N}\alpha\left(\psi_{i},\psi_{j}\right)c_{j}^{n}+\alpha\Delta
t%
\left(f^{n},\psi_{i}\right)," display="block"><semantics><mrow><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>=</mo><mrow><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></munderover><mrow><mi>α</mi><mo>⁢</mo><mrow><mo>(</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ψ</mi><mi>j</mi></msub><mo>)</mo></mrow><mo>⁢</mo><msubsup><mi>c</mi><mi>j</mi><mi>n</mi></msubsup></mrow></mrow><mo>+</mo><mrow><mi>α</mi><mo>⁢</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo>(</mo><msup><mi>f</mi><mi>n</mi></msup><mo>,</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo>)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">b_{i}=\sum_{j=0}^{N}\alpha\left(\psi_{i},\psi_{j}\right)c_{j}^{n}+\alpha\Delta
t%
\left(f^{n},\psi_{i}\right),</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.35)</span>
              
              
            
</div>
</div>
<div id="S3.SS1.p16" class="ltx_para ltx_noindent">
<p class="ltx_p">which can also be rewritten as:</p>
<div id="E36" class="ltx_equation ltx_eqn_div">
<span><math id="E36.m1" class="ltx_Math" alttext="(M+\alpha\Delta tK)c=\alpha Mc_{1}+\alpha\Delta tf." display="block"><semantics><mrow><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>M</mi><mo>+</mo><mrow><mi>α</mi><mo>⁢</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mi>K</mi></mrow></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mi>c</mi></mrow><mo>=</mo><mrow><mrow><mi>α</mi><mo>⁢</mo><mi>M</mi><mo>⁢</mo><msub><mi>c</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow><mi>α</mi><mo>⁢</mo><mi mathvariant="normal">Δ</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mi>f</mi></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">(M+\alpha\Delta tK)c=\alpha Mc_{1}+\alpha\Delta tf.</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.36)</span>
              
              
            
</div>
</div>
<div id="S3.SS1.p17" class="ltx_para">
<p class="ltx_p"><math id="S3.SS1.p17.m1" class="ltx_Math" alttext="M" display="inline"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math> (which traditionally is called the mass matrix), <math id="S3.SS1.p17.m2" class="ltx_Math" alttext="K" display="inline"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math> (which traditionally is called the stiffness matrix), <math id="S3.SS1.p17.m3" class="ltx_Math" alttext="f" display="inline"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>, <math id="S3.SS1.p17.m4" class="ltx_Math" alttext="c" display="inline"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>, and <math id="S3.SS1.p17.m5" class="ltx_Math" alttext="c_{1}" display="inline"><semantics><msub><mi>c</mi><mn>1</mn></msub><annotation encoding="application/x-tex">c_{1}</annotation></semantics></math> are defined as:</p>
</div>
<div id="S3.SS1.p18" class="ltx_para">
<div class="bml-overflow-wrapper">
<table id="E37" class="ltx_equationgroup ltx_eqn_table">

<tr id="E37X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E37X.m2" class="ltx_Math" alttext="\displaystyle M" display="inline"><semantics><mi>M</mi><annotation encoding="application/x-tex">\displaystyle M</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="E37X.m3" class="ltx_Math" alttext="\displaystyle=\left\{M_{i,j}\right\},\quad M_{i,j}=\left(\psi_{i},\psi_{j}%
\right),\quad i,j\in\mathcal{I}_{s}" display="inline"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mo>{</mo><msub><mi>M</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>}</mo></mrow></mrow><mo rspace="12.5pt">,</mo><mrow><mrow><msub><mi>M</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><mrow><mo>(</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ψ</mi><mi>j</mi></msub><mo>)</mo></mrow><mo rspace="12.5pt">,</mo><mi>i</mi></mrow></mrow><mo>,</mo><mrow><mi>j</mi><mo>∈</mo><msub><mi class="ltx_font_mathcaligraphic">ℐ</mi><mi>s</mi></msub></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\left\{M_{i,j}\right\},\quad M_{i,j}=\left(\psi_{i},\psi_{j}%
\right),\quad i,j\in\mathcal{I}_{s}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="5" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7.37)</span></td>
</tr>
<tr id="E37Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E37Xa.m2" class="ltx_Math" alttext="\displaystyle K" display="inline"><semantics><mi>K</mi><annotation encoding="application/x-tex">\displaystyle K</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="E37Xa.m3" class="ltx_Math" alttext="\displaystyle=\left\{K_{i,j}\right\},\quad K_{i,j}=\left(\nabla\psi_{i},D%
\nabla\psi_{j}\right),\quad i,j\in\mathcal{I}_{s}" display="inline"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mo>{</mo><msub><mi>K</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>}</mo></mrow></mrow><mo rspace="12.5pt">,</mo><mrow><mrow><msub><mi>K</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mo>∇</mo><mo>⁡</mo><msub><mi>ψ</mi><mi>i</mi></msub></mrow><mo>,</mo><mrow><mi>D</mi><mo>⁢</mo><mrow><mo>∇</mo><mo>⁡</mo><msub><mi>ψ</mi><mi>j</mi></msub></mrow></mrow><mo>)</mo></mrow><mo rspace="12.5pt">,</mo><mi>i</mi></mrow></mrow><mo>,</mo><mrow><mi>j</mi><mo>∈</mo><msub><mi class="ltx_font_mathcaligraphic">ℐ</mi><mi>s</mi></msub></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\left\{K_{i,j}\right\},\quad K_{i,j}=\left(\nabla\psi_{i},D%
\nabla\psi_{j}\right),\quad i,j\in\mathcal{I}_{s}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="E37Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E37Xb.m2" class="ltx_Math" alttext="\displaystyle f" display="inline"><semantics><mi>f</mi><annotation encoding="application/x-tex">\displaystyle f</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="E37Xb.m3" class="ltx_Math" alttext="\displaystyle=\left\{f_{i}\right\},\quad f_{i}=\left(f\left(\boldsymbol{x},t_{%
n}\right),\psi_{i}\right),\quad i\in\mathcal{I}_{s}" display="inline"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mo>{</mo><msub><mi>f</mi><mi>i</mi></msub><mo>}</mo></mrow></mrow><mo rspace="12.5pt">,</mo><mrow><mrow><msub><mi>f</mi><mi>i</mi></msub><mo>=</mo><mrow><mo>(</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo>(</mo><mi>𝒙</mi><mo>,</mo><msub><mi>t</mi><mi>n</mi></msub><mo>)</mo></mrow></mrow><mo>,</mo><msub><mi>ψ</mi><mi>i</mi></msub><mo>)</mo></mrow></mrow><mo rspace="12.5pt">,</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi class="ltx_font_mathcaligraphic">ℐ</mi><mi>s</mi></msub></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\left\{f_{i}\right\},\quad f_{i}=\left(f\left(\boldsymbol{x},t_{%
n}\right),\psi_{i}\right),\quad i\in\mathcal{I}_{s}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="E37Xc" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E37Xc.m2" class="ltx_Math" alttext="\displaystyle c" display="inline"><semantics><mi>c</mi><annotation encoding="application/x-tex">\displaystyle c</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="E37Xc.m3" class="ltx_Math" alttext="\displaystyle=\left\{c_{i}\right\},\quad i\in\mathcal{I}_{s}" display="inline"><semantics><mrow><mrow><mi></mi><mo>=</mo><mrow><mo>{</mo><msub><mi>c</mi><mi>i</mi></msub><mo>}</mo></mrow></mrow><mo rspace="12.5pt">,</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi class="ltx_font_mathcaligraphic">ℐ</mi><mi>s</mi></msub></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\left\{c_{i}\right\},\quad i\in\mathcal{I}_{s}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="E37Xd" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="E37Xd.m2" class="ltx_Math" alttext="\displaystyle c_{1}" display="inline"><semantics><msub><mi>c</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\displaystyle c_{1}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="E37Xd.m3" class="ltx_Math" alttext="\displaystyle=\left\{c_{i}^{n}\right\},\quad i\in\mathcal{I}_{s}." display="inline"><semantics><mrow><mrow><mrow><mi></mi><mo>=</mo><mrow><mo>{</mo><msubsup><mi>c</mi><mi>i</mi><mi>n</mi></msubsup><mo>}</mo></mrow></mrow><mo rspace="12.5pt">,</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi class="ltx_font_mathcaligraphic">ℐ</mi><mi>s</mi></msub></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\left\{c_{i}^{n}\right\},\quad i\in\mathcal{I}_{s}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</table>
</div>
</div>
<div id="S3.SS1.p19" class="ltx_para">
<p class="ltx_p">By solving Eq. <a href="#E33" title="(7.33) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.33</span></a> and substituting the obtained <math id="S3.SS1.p19.m1" class="ltx_Math" alttext="c" display="inline"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math> in Eq. <a href="#E31" title="(7.31) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.31</span></a>, <math id="S3.SS1.p19.m2" class="ltx_Math" alttext="u" display="inline"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math> (<math id="S3.SS1.p19.m3" class="ltx_Math" alttext="C_{\mathrm{Mg}}" display="inline"><semantics><msub><mi>C</mi><mi>Mg</mi></msub><annotation encoding="application/x-tex">C_{\mathrm{Mg}}</annotation></semantics></math> in the example in this study) can be calculated in the current time step. As stated before, the same approach can be applied to Eq. <a href="#E11" title="(7.11) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.11</span></a> and Eq. <a href="#E17" title="(7.17) ‣ 7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.17</span></a> to get <math id="S3.SS1.p19.m4" class="ltx_Math" alttext="C_{\mathrm{Film}}" display="inline"><semantics><msub><mi>C</mi><mi>Film</mi></msub><annotation encoding="application/x-tex">C_{\mathrm{Film}}</annotation></semantics></math> and <math id="S3.SS1.p19.m5" class="ltx_Math" alttext="\phi" display="inline"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>. This procedure is repeated in each time step to compute the values of <math id="S3.SS1.p19.m6" class="ltx_Math" alttext="C_{\mathrm{Mg}}" display="inline"><semantics><msub><mi>C</mi><mi>Mg</mi></msub><annotation encoding="application/x-tex">C_{\mathrm{Mg}}</annotation></semantics></math>, <math id="S3.SS1.p19.m7" class="ltx_Math" alttext="C_{\mathrm{Film}}" display="inline"><semantics><msub><mi>C</mi><mi>Film</mi></msub><annotation encoding="application/x-tex">C_{\mathrm{Film}}</annotation></semantics></math>, and <math id="S3.SS1.p19.m8" class="ltx_Math" alttext="\phi" display="inline"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math> over time.</p>
</div>
<div id="S3.SS1.p20" class="ltx_para">
<p class="ltx_p">A common practice to save time for solving Eq. <a href="#E33" title="(7.33) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.33</span></a> for a constant time step size is to compute the left-hand side matrix (<math id="S3.SS1.p20.m1" class="ltx_Math" alttext="A" display="inline"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math> in Eq. <a href="#E34" title="(7.34) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.34</span></a>) once and compute only the right-hand side vector of the equation at each time iteration. But in this case, although the time step size is fixed, due to the presence of the <math id="S3.SS1.p20.m2" class="ltx_Math" alttext="\alpha" display="inline"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> coefficient, the matrix changes along the time. The <math id="S3.SS1.p20.m3" class="ltx_Math" alttext="\alpha" display="inline"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> coefficient is not constant and should be updated in each time step because it depends on the saturation term <math id="S3.SS1.p20.m4" class="ltx_Math" alttext="s" display="inline"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math> (which is a function of the concentration of the film as can be seen by comparing Eq. <a href="#E10" title="(7.10) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.10</span></a> and Eq. <a href="#E18" title="(7.18) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.18</span></a>). In addition to this, the diffusion coefficient is not constant (Eq. <a href="#E12" title="(7.12) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.12</span></a>), making the second term in Eq. <a href="#E34" title="(7.34) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.34</span></a> non-constant even in the absence of <math id="S3.SS1.p20.m5" class="ltx_Math" alttext="\alpha" display="inline"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> coefficient. Consequently, the left-hand side matrix of the Eq. <a href="#E33" title="(7.33) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.33</span></a> cannot be computed before the start of the main time loop, and computing it in each time step is an extra but inevitable computational task in comparison to similar efficient and high-performance finite element implementations. This contributes to a slower algorithm for solving the aforementioned PDEs.</p>
</div>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection normal">
<div class="section level3">

<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection header-section-number">7.3.2</span> Implementation and parallelization</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p class="ltx_p">The model was implemented in FreeFEM <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib44" title="New development in freefem++" class="ltx_ref">112</a>]</cite>, which is an open-source PDE solver to facilitate converting the weak formulation (Eq. <a href="#E27" title="(7.27) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.27</span></a>) to a linear system <math id="S3.SS2.p1.m1" class="ltx_Math" alttext="Ax=b" display="inline"><semantics><mrow><mrow><mi>A</mi><mo>⁢</mo><mi>x</mi></mrow><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Ax=b</annotation></semantics></math> (with <math id="S3.SS2.p1.m2" class="ltx_Math" alttext="A" display="inline"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math> from Eq. <a href="#E34" title="(7.34) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.34</span></a> and <math id="S3.SS2.p1.m3" class="ltx_Math" alttext="b" display="inline"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math> from Eq. <a href="#E35" title="(7.35) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.35</span></a>). The computational mesh was generated using Netgen <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib47" title="NETGEN an advancing front 2d/3d-mesh generator based on abstract rules" class="ltx_ref">233</a>]</cite> in the SALOME platform <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib48" title="Salome platform component model for numerical simulation" class="ltx_ref">217</a>]</cite> by a set of linear tetrahedral elements, and all the other preprocessing steps were performed in FreeFEM. The mesh was adaptively refined on the material-medium interface in order to increase the accuracy of the level set model. Postprocessing of the results was carried out using Paraview <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib56" title="Paraview: an end-user tool for large data visualization" class="ltx_ref">8</a>]</cite>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p class="ltx_p">Computing the diffusion solely in the medium domain causes oscillations close to the interface, and to prevent this, the mass lumping feature of FreeFEM was employed. In this technique, the desired mass matrix is handled node-wise and not element-wise. Technically speaking, this means that the state variable is stored in the mesh nodes, and although this is the natural formulation in the finite difference method, it requires artificial modification in the standard finite element formulation <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib105" title="Numerical experiments on mass lumping for the advection-diffusion equation" class="ltx_ref">274</a>]</cite>. The mass lumping feature of FreeFEM applies a quadratic formula at the vertices of elements to make the mass matrix diagonal, which contributes positively to the convergence of the solution.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p class="ltx_p">The main parallelization approach for the current study was domain decomposition, in which the mesh is split into smaller domains (can be overlapping or non-overlapping), and the global solution of the linear system is achieved by solving the problem on each smaller local mesh. What really matters in this approach is providing virtual boundary conditions to the smaller sub-domains by ghost elements, transferring neighboring sub-domain solutions <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib60" title="High performance computation of radiative transfer equation using the finite element method" class="ltx_ref">21</a>]</cite>. As a result, a high-performance parallelism is feasible by assigning each sub-domain to one processing unit.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p class="ltx_p">In computational science, preconditioning is widely used to enhance the convergence, which means instead of directly working with a linear system <math id="S3.SS2.p4.m1" class="ltx_Math" alttext="Ax=b" display="inline"><semantics><mrow><mrow><mi>A</mi><mo>⁢</mo><mi>x</mi></mrow><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Ax=b</annotation></semantics></math>, one can consider the preconditioned system <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib62" title="A multilevel schwarz preconditioner based on a hierarchy of robust coarse spaces" class="ltx_ref">62</a>]</cite>:</p>
<div id="E38" class="ltx_equation ltx_eqn_div">
<span><math id="E38.m1" class="ltx_Math" alttext="M^{-1}Ax=M^{-1}b" display="block"><semantics><mrow><mrow><msup><mi>M</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>x</mi></mrow><mo>=</mo><mrow><msup><mi>M</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>⁢</mo><mi>b</mi></mrow></mrow><annotation encoding="application/x-tex">M^{-1}Ax=M^{-1}b</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.38)</span>
              
              
            
</div>
<p class="ltx_p">in which the <math id="S3.SS2.p4.m2" class="ltx_Math" alttext="M^{-1}" display="inline"><semantics><msup><mi>M</mi><mrow><mo>-</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">M^{-1}</annotation></semantics></math> is the preconditioner. In the current study, we considered this approach for both the domain composition and the solution of the linear system. We opted to use an overlapping Schwarz method for domain decomposition, in which the mesh is first divided into a graph of <math id="S3.SS2.p4.m3" class="ltx_Math" alttext="N" display="inline"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math> non-overlapping meshes using METIS (or ParMETIS) <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib65" title="A fast and high quality multilevel scheme for partitioning irregular graphs" class="ltx_ref">144</a>]</cite>. Then, by defining a positive number <math id="S3.SS2.p4.m4" class="ltx_Math" alttext="\delta" display="inline"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>, the overlapping decomposition <math id="S3.SS2.p4.m5" class="ltx_Math" alttext="\left\{\mathcal{T}_{i}^{\delta}\right\}_{1\leqslant i\leqslant N}" display="inline"><semantics><msub><mrow><mo>{</mo><msubsup><mi class="ltx_font_mathcaligraphic">𝒯</mi><mi>i</mi><mi>δ</mi></msubsup><mo>}</mo></mrow><mrow><mn>1</mn><mo>⩽</mo><mi>i</mi><mo>⩽</mo><mi>N</mi></mrow></msub><annotation encoding="application/x-tex">\left\{\mathcal{T}_{i}^{\delta}\right\}_{1\leqslant i\leqslant N}</annotation></semantics></math> can be created recursively for each sub-mesh <math id="S3.SS2.p4.m6" class="ltx_Math" alttext="\left\{\mathcal{T}_{i}\right\}_{1\leqslant i\leqslant N}" display="inline"><semantics><msub><mrow><mo>{</mo><msub><mi class="ltx_font_mathcaligraphic">𝒯</mi><mi>i</mi></msub><mo>}</mo></mrow><mrow><mn>1</mn><mo>⩽</mo><mi>i</mi><mo>⩽</mo><mi>N</mi></mrow></msub><annotation encoding="application/x-tex">\left\{\mathcal{T}_{i}\right\}_{1\leqslant i\leqslant N}</annotation></semantics></math> by adding all adjacent elements of <math id="S3.SS2.p4.m7" class="ltx_Math" alttext="\mathcal{T}_{i}^{\delta-1}" display="inline"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">𝒯</mi><mi>i</mi><mrow><mi>δ</mi><mo>-</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">\mathcal{T}_{i}^{\delta-1}</annotation></semantics></math> to it. Then, the finite element space <math id="S3.SS2.p4.m8" class="ltx_Math" alttext="\mathcal{V}_{h}" display="inline"><semantics><msub><mi class="ltx_font_mathcaligraphic">𝒱</mi><mi>h</mi></msub><annotation encoding="application/x-tex">\mathcal{V}_{h}</annotation></semantics></math> (Eq. <a href="#E19" title="(7.19) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.19</span></a>) can be mapped to the local space <math id="S3.SS2.p4.m9" class="ltx_Math" alttext="\left\{\mathcal{V}_{i}^{\delta}\right\}_{1\leqslant i\leqslant N}" display="inline"><semantics><msub><mrow><mo>{</mo><msubsup><mi class="ltx_font_mathcaligraphic">𝒱</mi><mi>i</mi><mi>δ</mi></msubsup><mo>}</mo></mrow><mrow><mn>1</mn><mo>⩽</mo><mi>i</mi><mo>⩽</mo><mi>N</mi></mrow></msub><annotation encoding="application/x-tex">\left\{\mathcal{V}_{i}^{\delta}\right\}_{1\leqslant i\leqslant N}</annotation></semantics></math> by considering the restrictions <math id="S3.SS2.p4.m10" class="ltx_Math" alttext="\left\{R_{i}\right\}_{1\leqslant i\leqslant N}" display="inline"><semantics><msub><mrow><mo>{</mo><msub><mi>R</mi><mi>i</mi></msub><mo>}</mo></mrow><mrow><mn>1</mn><mo>⩽</mo><mi>i</mi><mo>⩽</mo><mi>N</mi></mrow></msub><annotation encoding="application/x-tex">\left\{R_{i}\right\}_{1\leqslant i\leqslant N}</annotation></semantics></math> and a local partition of unity <math id="S3.SS2.p4.m11" class="ltx_Math" alttext="\left\{D_{i}\right\}_{1\leqslant i\leqslant N}" display="inline"><semantics><msub><mrow><mo>{</mo><msub><mi>D</mi><mi>i</mi></msub><mo>}</mo></mrow><mrow><mn>1</mn><mo>⩽</mo><mi>i</mi><mo>⩽</mo><mi>N</mi></mrow></msub><annotation encoding="application/x-tex">\left\{D_{i}\right\}_{1\leqslant i\leqslant N}</annotation></semantics></math> such that:</p>
<div id="E39" class="ltx_equation ltx_eqn_div">
<span><math id="E39.m1" class="ltx_Math" alttext="\sum_{j=1}^{N}R_{j}^{\top}D_{j}R_{j}=I_{n\times n}" display="block"><semantics><mrow><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><msubsup><mi>R</mi><mi>j</mi><mo>⊤</mo></msubsup><mo>⁢</mo><msub><mi>D</mi><mi>j</mi></msub><mo>⁢</mo><msub><mi>R</mi><mi>j</mi></msub></mrow></mrow><mo>=</mo><msub><mi>I</mi><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sum_{j=1}^{N}R_{j}^{\top}D_{j}R_{j}=I_{n\times n}</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.39)</span>
              
              
            
</div>
<p class="ltx_p">where <math id="S3.SS2.p4.m12" class="ltx_Math" alttext="I" display="inline"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math> and <math id="S3.SS2.p4.m13" class="ltx_Math" alttext="n" display="inline"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> denote identity matrix and the global number of unknowns, respectively <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib63" title="An introduction to domain decomposition methods" class="ltx_ref">68</a>]</cite>.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p class="ltx_p">In this study, we decomposed the mesh by using the one-level preconditioner Restricted Additive Schwarz (RAS):</p>
<div id="E40" class="ltx_equation ltx_eqn_div">
<span><math id="E40.m1" class="ltx_Math" alttext="M_{\mathrm{RAS}}^{-1}=\sum_{i=1}^{N}R_{i}^{\top}D_{i}A_{i}^{-1}R_{i}" display="block"><semantics><mrow><msubsup><mi>M</mi><mi>RAS</mi><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mo>=</mo><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><msubsup><mi>R</mi><mi>i</mi><mo>⊤</mo></msubsup><mo>⁢</mo><msub><mi>D</mi><mi>i</mi></msub><mo>⁢</mo><msubsup><mi>A</mi><mi>i</mi><mrow><mo>-</mo><mn>1</mn></mrow></msubsup><mo>⁢</mo><msub><mi>R</mi><mi>i</mi></msub></mrow></mrow></mrow><annotation encoding="application/x-tex">M_{\mathrm{RAS}}^{-1}=\sum_{i=1}^{N}R_{i}^{\top}D_{i}A_{i}^{-1}R_{i}</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.40)</span>
              
              
            
</div>
<p class="ltx_p">in which <math id="S3.SS2.p5.m1" class="ltx_Math" alttext="\left\{A_{i}\right\}_{1\leqslant i\leqslant N}" display="inline"><semantics><msub><mrow><mo>{</mo><msub><mi>A</mi><mi>i</mi></msub><mo>}</mo></mrow><mrow><mn>1</mn><mo>⩽</mo><mi>i</mi><mo>⩽</mo><mi>N</mi></mrow></msub><annotation encoding="application/x-tex">\left\{A_{i}\right\}_{1\leqslant i\leqslant N}</annotation></semantics></math> is the local operator of the sub-matrices <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib63" title="An introduction to domain decomposition methods" class="ltx_ref">68</a>]</cite>. For this purpose, we took advantage of the HPDDM (high-performance domain decomposition methods) package interface in FreeFEM <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib64" title="Scalable domain decomposition preconditioners for heterogeneous elliptic problems" class="ltx_ref">140</a>]</cite>. The partitioned mesh is shown in Fig. <a href="#F3" title="Figure 7.3 ‣ 7.3.2 Implementation and parallelization ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.3</span></a>. The effect of the construction of these local sub-domains on the sparsity pattern of the global matrix is also depicted in Fig. <a href="#F4" title="Figure 7.4 ‣ 7.3.2 Implementation and parallelization ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.4</span></a>. The global matrix is a sparse matrix according to Eq. <a href="#E34" title="(7.34) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.34</span></a> and the definition of the basis function <math id="S3.SS2.p5.m2" class="ltx_Math" alttext="\psi" display="inline"><semantics><mi>ψ</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>.</p>
</div>
<figure id="F3" class="ltx_figure"><div class="bml-overflow-wrapper"><img src="chapters/hpc/image/overlap.jpg" id="F3.g1" class="ltx_graphics ltx_centering" width="325" height="243" alt="Overlapping domain decomposition in the current study. Each color shows a separate sub-domain, and the narrow lighter bands are the overlapped regions."></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.3: </span>Overlapping domain decomposition in the current study. Each color shows a separate sub-domain, and the narrow lighter bands are the overlapped regions.</figcaption>
</figure>
<figure id="F4" class="ltx_figure"><div class="bml-overflow-wrapper"><img src="chapters/hpc/image/sparsity_pattern.jpg" id="F4.g1" class="ltx_graphics ltx_centering" width="541" height="159" alt="Comparison of the sparsity patterns (highlighting non-zero elements) of the global matrix A for a different number of decomposed domains a: 1 domain b: 2 sub-domains c: 4 sub-domains d: 8 sub-domains."></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.4: </span>Comparison of the sparsity patterns (highlighting non-zero elements) of the global matrix A for a different number of decomposed domains a: 1 domain b: 2 sub-domains c: 4 sub-domains d: 8 sub-domains.</figcaption>
</figure>
<div id="S3.SS2.p6" class="ltx_para">
<p class="ltx_p">Generally, two categories of methods have been used to solve a large linear system of equations on parallel machines: direct solvers (e.g. Multifrontal Massively Parallel Sparse, MUMPS <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib45" title="A fully asynchronous multifrontal solver using distributed dynamic scheduling" class="ltx_ref">14</a>]</cite>) and iterative solvers (e.g. Generalized Minimal Residual Method, GMRES <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib66" title="GMRES: a generalized minimal residual algorithm for solving nonsymmetric linear systems" class="ltx_ref">223</a>]</cite>). While direct solvers are quite robust, they suffer from the memory requirement problem on large systems. Inversely, iterative solvers are quite efficient on memory consumption, but similar to other iterative approaches, they are not very reliable in some cases <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib67" title="Iterative methods for sparse linear systems" class="ltx_ref">224</a>]</cite>. Direct solvers modify the matrix by factorization (e.g. Cholesky decomposition), but an iterative solver does not manipulate the matrix and works solely using basic algebraic operations. However, for an efficient usage of iterative solvers, a proper preconditioner is crucial <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib67" title="Iterative methods for sparse linear systems" class="ltx_ref">224</a>]</cite>. By evaluating and comparing the performance of the aforementioned methods for the current model, we decided to use an iterative approach using the Krylov subspaces (KSP) method, in which we preconditioned the equation using a proper preconditioner (Eq. <a href="#E38" title="(7.38) ‣ 7.3.2 Implementation and parallelization ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.38</span></a>) and then solved it with an iterative solver.</p>
</div>
<div id="S3.SS2.p7" class="ltx_para">
<p class="ltx_p">Krylov methods have been frequently used by researchers as robust iterative approaches to parallelism <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib68" title="The idea behind krylov methods" class="ltx_ref">131</a>]</cite>. What matters in this regard is ensuring proper scaling of the parallelized algorithm for both the assembling of the matrices and the solution of the linear system of equations. One good solution to this challenge is taking advantage of HPC-ready mathematical libraries to achieve efficient distributed-memory parallelism through the Message Passing Interface (MPI). In the current study, we used the PETSc (Portable, Extensible Toolkit for Scientific Computation) library <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib61" title="PETSc Web page" class="ltx_ref">25</a>]</cite>, which provides a collection of high-performance preconditioners and solvers for this purpose.</p>
</div>
<div id="S3.SS2.p8" class="ltx_para">
<p class="ltx_p">In order to yield the highest performance, a variety of different combinations of KSP types and preconditioners were evaluated, such as Conjugate Gradients (CG) <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib99" title="Methods of conjugate gradients for solving linear systems" class="ltx_ref">115</a>]</cite>, Successive Over-Relaxation (SOR) <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib100" title="Symmetric successive overrelaxation in solving diffusion difference equations" class="ltx_ref">104</a>]</cite>, block Jacobi, and Algebraic Multigrid (AMG) <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib101" title="Multigrid methods" class="ltx_ref">187</a>]</cite>, to name a few. The performance tests results are presented in the appendix section of this chapter. The best performance for the reaction-diffusion system model was achieved using the HYPRE preconditioner <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib69" title="Hypre: a library of high performance preconditioners" class="ltx_ref">78</a>]</cite> and the GMRES solver <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib66" title="GMRES: a generalized minimal residual algorithm for solving nonsymmetric linear systems" class="ltx_ref">223</a>]</cite>. This was the combination used for all the performance analysis tests.</p>
</div>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection normal">
<div class="section level3">

<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection header-section-number">7.3.3</span> Level-set issues</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p class="ltx_p">As mentioned before, in order to track the interface of the bulk material and the surrounding fluid, an implicit signed distance function is defined as the solution of Eq. <a href="#E17" title="(7.17) ‣ 7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.17</span></a>. This equation can be solved using the aforementioned finite element discretization, but in a practical implementation, there are usually a couple of problems associated with this PDE.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p class="ltx_p">The first issue is defining <math id="S3.SS3.p2.m1" class="ltx_Math" alttext="D_{\mathrm{Mg}}^{e}" display="inline"><semantics><msubsup><mi>D</mi><mi>Mg</mi><mi>e</mi></msubsup><annotation encoding="application/x-tex">D_{\mathrm{Mg}}^{e}</annotation></semantics></math> and <math id="S3.SS3.p2.m2" class="ltx_Math" alttext="\nabla_{n}C_{\mathrm{Mg}}" display="inline"><semantics><mrow><msub><mo>∇</mo><mi>n</mi></msub><mo>⁡</mo><msub><mi>C</mi><mi>Mg</mi></msub></mrow><annotation encoding="application/x-tex">\nabla_{n}C_{\mathrm{Mg}}</annotation></semantics></math> on the moving interface. To ensure correct boundary conditions for Eq. <a href="#E16" title="(7.16) ‣ 7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.16</span></a>, the value of <math id="S3.SS3.p2.m3" class="ltx_Math" alttext="C_{\mathrm{Mg}}" display="inline"><semantics><msub><mi>C</mi><mi>Mg</mi></msub><annotation encoding="application/x-tex">C_{\mathrm{Mg}}</annotation></semantics></math> is set constant on the whole bulk material by using the penalty method. As a result, the implicit interface is not necessarily aligned on the computational mesh. Although this is a beneficial fact for the interface tracking, it inserts the problem of overestimation of <math id="S3.SS3.p2.m4" class="ltx_Math" alttext="C_{\mathrm{Mg}}" display="inline"><semantics><msub><mi>C</mi><mi>Mg</mi></msub><annotation encoding="application/x-tex">C_{\mathrm{Mg}}</annotation></semantics></math> on the nodes close to the interface, which makes it difficult to calculate <math id="S3.SS3.p2.m5" class="ltx_Math" alttext="\nabla_{n}C_{\mathrm{Mg}}" display="inline"><semantics><mrow><msub><mo>∇</mo><mi>n</mi></msub><mo>⁡</mo><msub><mi>C</mi><mi>Mg</mi></msub></mrow><annotation encoding="application/x-tex">\nabla_{n}C_{\mathrm{Mg}}</annotation></semantics></math> on these nodes correctly. The same problem exists for calculating <math id="S3.SS3.p2.m6" class="ltx_Math" alttext="D_{\mathrm{Mg}}^{e}" display="inline"><semantics><msubsup><mi>D</mi><mi>Mg</mi><mi>e</mi></msubsup><annotation encoding="application/x-tex">D_{\mathrm{Mg}}^{e}</annotation></semantics></math>. To overcome this issue, the values of <math id="S3.SS3.p2.m7" class="ltx_Math" alttext="C_{\mathrm{Mg}}" display="inline"><semantics><msub><mi>C</mi><mi>Mg</mi></msub><annotation encoding="application/x-tex">C_{\mathrm{Mg}}</annotation></semantics></math> and <math id="S3.SS3.p2.m8" class="ltx_Math" alttext="D_{\mathrm{Mg}}^{e}" display="inline"><semantics><msubsup><mi>D</mi><mi>Mg</mi><mi>e</mi></msubsup><annotation encoding="application/x-tex">D_{\mathrm{Mg}}^{e}</annotation></semantics></math> are calculated at the distance <math id="S3.SS3.p2.m9" class="ltx_Math" alttext="h" display="inline"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math> from the interface in the normal direction (towards the medium), where <math id="S3.SS3.p2.m10" class="ltx_Math" alttext="h" display="inline"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math> is the edge size of the smallest element of the computational mesh.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p class="ltx_p">The next issue is a well-known problem of the level set method: if the velocity of the interface is not constant (as in Eq. <a href="#E13" title="(7.13) ‣ 7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.13</span></a>), the level set function <math id="S3.SS3.p3.m1" class="ltx_Math" alttext="\phi" display="inline"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math> may become distorted by having too flat or too steep gradients close to the moving front. This could cause unwanted movements of the interface. The problem becomes even worse when the distance function is advected. A solution to this issue is re-initializing the distance function in each time step (re-distancing), but this operation requires solving a new PDE. From numerical investigations, it has been observed that this operation inserts new errors in the numerical computation of the level set equation <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib43" title="A remark on computing distance functions" class="ltx_ref">222</a>]</cite>. This can be resolved by improving the method of reconstruction of the distance function <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib43" title="A remark on computing distance functions" class="ltx_ref">222</a>]</cite>.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p class="ltx_p">However, re-initialization results in another issue on a massively parallel implementation: as the mesh is partitioned into smaller sub-meshes, it is not feasible anymore to evaluate the distance to the interface globally on each sub-domain. As a result, the inverse process of domain decomposition should be taken to assemble the mesh again. This can be done by the restriction matrix and the partition of unity (defined in Eqs. <a href="#E39" title="(7.39) ‣ 7.3.2 Implementation and parallelization ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.39</span></a> and <a href="#E40" title="(7.40) ‣ 7.3.2 Implementation and parallelization ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.40</span></a>), but it is rather a very inefficient procedure regarding the parallelization of the simulation and results in a long execution time in each time step.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p class="ltx_p">In the current study, the distance function <math id="S3.SS3.p5.m1" class="ltx_Math" alttext="\phi" display="inline"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math> was initialized only once at the beginning of the simulation. The re-initialization process was unnecessary in this case because according to Eq. <a href="#E17" title="(7.17) ‣ 7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.17</span></a>, the distance function is advected only in the regions where there is a gradient of the concentration of Mg ions, which means that advection is applied only on the regions close to the interface in the medium. This prevented the whole distance function of being distorted, and as a result, it was not required to re-initialize it in each time step. This also removed the need for inverting the decomposition process.</p>
</div>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection normal">
<div class="section level3">

<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection header-section-number">7.3.4</span> Simulation setup</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p class="ltx_p">In order to verify the performance of the developed model, a degradation experiment was reconstructed in-silico, in which the degradation of a block of Mg (with the size of <math id="S3.SS4.p1.m1" class="ltx_Math" alttext="13mm\times 13mm\times 4mm" display="inline"><semantics><mrow><mrow><mrow><mrow><mrow><mn>13</mn><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>m</mi></mrow><mo>×</mo><mn>13</mn></mrow><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>m</mi></mrow><mo>×</mo><mn>4</mn></mrow><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">13mm\times 13mm\times 4mm</annotation></semantics></math>) was investigated in a simulated body fluid solution. All the experimental parameter data (used to setup the simulation), as well as the degradation rates (used to calibrate and validate the numerical model) were extracted from <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib12" title="The role of individual components of simulated body fluid on the corrosion behavior of commercially pure mg" class="ltx_ref">192</a>]</cite>.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p class="ltx_p">As can be seen in Eqs. <a href="#E1" title="(7.1) ‣ 7.2.1 Chemistry of degradation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.1</span></a> and <a href="#E2" title="(7.2) ‣ 7.2.1 Chemistry of degradation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.2</span></a>, each mole removed from the Mg block corresponds to one mole of the produced hydrogen. As a result, instead of a direct measurement of mass loss, one can collect and measure the amount of produced hydrogen to monitor the degradation rate. This is a common way of reporting degradation in this type of studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib97" title="The in vivo and in vitro corrosion of high-purity magnesium and magnesium alloys WZ21 and AZ91" class="ltx_ref">4</a>]</cite>. In order to get this quantity out of the developed model, we used the level set model output. The total mass loss of Mg at each desired time can be calculated based on the movement of the corrosion front:</p>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<div id="E41" class="ltx_equation ltx_eqn_div">
<span><math id="E41.m1" class="ltx_Math" alttext="\mathrm{Mg}_{\mathrm{lost}}=\int_{\Omega_{+}(t)}\mathrm{Mg}_{\mathrm{solid}}%
\mathrm{d}V-\int_{\Omega_{+}(0)}\mathrm{Mg}_{\mathrm{solid}}\mathrm{d}V" display="block"><semantics><mrow><msub><mi>Mg</mi><mi>lost</mi></msub><mo>=</mo><mrow><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mrow><msub><mi mathvariant="normal">Ω</mi><mo>+</mo></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow></msub><mrow><msub><mi>Mg</mi><mi>solid</mi></msub><mo>⁢</mo><mrow><mo rspace="0pt">d</mo><mi>V</mi></mrow></mrow></mrow><mo>-</mo><mrow><msub><mo largeop="true" symmetric="true">∫</mo><mrow><msub><mi mathvariant="normal">Ω</mi><mo>+</mo></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></msub><mrow><msub><mi>Mg</mi><mi>solid</mi></msub><mo>⁢</mo><mrow><mo rspace="0pt">d</mo><mi>V</mi></mrow></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\mathrm{Mg}_{\mathrm{lost}}=\int_{\Omega_{+}(t)}\mathrm{Mg}_{\mathrm{solid}}%
\mathrm{d}V-\int_{\Omega_{+}(0)}\mathrm{Mg}_{\mathrm{solid}}\mathrm{d}V</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.41)</span>
              
              
            
</div>
<p class="ltx_p">where <math id="S3.SS4.p3.m1" class="ltx_Math" alttext="\Omega_{+}(t)=\{\mathbf{x}:\phi(\mathbf{x},t)\geq 0\}" display="inline"><semantics><mrow><mrow><msub><mi mathvariant="normal">Ω</mi><mo>+</mo></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy="false">{</mo><mi>𝐱</mi><mo>:</mo><mrow><mrow><mi>ϕ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐱</mi><mo>,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow><mo>≥</mo><mn>0</mn></mrow><mo stretchy="false">}</mo></mrow></mrow><annotation encoding="application/x-tex">\Omega_{+}(t)=\{\mathbf{x}:\phi(\mathbf{x},t)\geq 0\}</annotation></semantics></math>. It is worth noting that this integration should be performed by ignoring the ghost elements generated in the mesh partitioning process, otherwise the calculated material loss will be higher than the real value. Then, the amount of formed hydrogen gas can be calculated based on the ideal gas law:</p>
</div>
<div id="S3.SS4.p4" class="ltx_para">
<div id="E42" class="ltx_equation ltx_eqn_div">
<span><math id="E42.m1" class="ltx_Math" alttext="H_{f}=\frac{\mathrm{Mg}_{\mathrm{lost}}}{\mathrm{Mg}_{\mathrm{mol}}}\frac{RT}{PA}" display="block"><semantics><mrow><msub><mi>H</mi><mi>f</mi></msub><mo>=</mo><mrow><mfrac><msub><mi>Mg</mi><mi>lost</mi></msub><msub><mi>Mg</mi><mi>mol</mi></msub></mfrac><mo>⁢</mo><mfrac><mrow><mi>R</mi><mo>⁢</mo><mi>T</mi></mrow><mrow><mi>P</mi><mo>⁢</mo><mi>A</mi></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">H_{f}=\frac{\mathrm{Mg}_{\mathrm{lost}}}{\mathrm{Mg}_{\mathrm{mol}}}\frac{RT}{PA}</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.42)</span>
              
              
            
</div>
<p class="ltx_p">in which <math id="S3.SS4.p4.m1" class="ltx_Math" alttext="R" display="inline"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math> is the universal gas constant, <math id="S3.SS4.p4.m2" class="ltx_Math" alttext="P" display="inline"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math> is the pressure, <math id="S3.SS4.p4.m3" class="ltx_Math" alttext="T" display="inline"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math> is the solution temperature, <math id="S3.SS4.p4.m4" class="ltx_Math" alttext="A" display="inline"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math> is the exposed corrosion surface area (which can be computed using the level set function), and <math id="S3.SS4.p4.m5" class="ltx_Math" alttext="\mathrm{Mg}_{\mathrm{mol}}" display="inline"><semantics><msub><mi>Mg</mi><mi>mol</mi></msub><annotation encoding="application/x-tex">\mathrm{Mg}_{\mathrm{mol}}</annotation></semantics></math> is the molar mass of Mg. Plotting a comparison of the predicted and experimentally obtained values of hydrogen can show the overall validity of the mathematical model because both the diffusion-reaction equations and the level set equation contribute to the prediction made by the computational model.</p>
</div>
<div id="S3.SS4.p5" class="ltx_para">
<p class="ltx_p">The geometry of the simulation experiment is depicted in Fig. <a href="#F5" title="Figure 7.5 ‣ 7.3.4 Simulation setup ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.5</span></a>. Based on this geometry, an Eulerian computational mesh was constructed by generating tetrahedral elements on the whole domain, including the Mg block and the medium. This resulted in <math id="S3.SS4.p5.m1" class="ltx_Math" alttext="{830808}" display="inline"><semantics><mn>830808</mn><annotation encoding="application/x-tex">{830808}</annotation></semantics></math> elements with a total of <math id="S3.SS4.p5.m2" class="ltx_Math" alttext="{143719}" display="inline"><semantics><mn>143719</mn><annotation encoding="application/x-tex">{143719}</annotation></semantics></math> DOFs for each PDE (Eqs. <a href="#E10" title="(7.10) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.10</span></a>, <a href="#E11" title="(7.11) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.11</span></a>, and <a href="#E17" title="(7.17) ‣ 7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.17</span></a>), which indicates the size of matrix <math id="S3.SS4.p5.m3" class="ltx_Math" alttext="A" display="inline"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math> in Eq. <a href="#E34" title="(7.34) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.34</span></a>. Model parameters and material properties were obtained from <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib53" title="Mathematical modelling of the degradation behaviour of biodegradable metals" class="ltx_ref">23</a>]</cite>. The diffusion coefficient of Mg was calculated using an inverse problem setup in which a Bayesian optimization process <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib76" title="Bayesian approach to global optimization" class="ltx_ref">196</a>]</cite> was used to run the simulation code multiple times and minimize the difference of the model output and the experimental data reported by <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib12" title="The role of individual components of simulated body fluid on the corrosion behavior of commercially pure mg" class="ltx_ref">192</a>]</cite>. A time step convergence study was performed to measure the sensitivity of the model to the time stepping parameter, and based on the results, the time step value was set to 0.025 hours.</p>
</div>
<figure id="F5" class="ltx_figure"><div class="bml-overflow-wrapper"><img src="chapters/core/image/simulation_setup.jpg" id="F5.g1" class="ltx_graphics ltx_centering" width="541" height="179" alt="Representation of the experimental set-up simulated to perform numerical validation of the developed model and evaluate parallel performance. a) A cuboid of Mg (with the size of "></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.5: </span>Representation of the experimental set-up simulated to perform numerical validation of the developed model and evaluate parallel performance. a) A cuboid of Mg (with the size of <math id="F5.m1" class="ltx_Math" alttext="13mm\times 13mm\times 4mm" display="inline"><semantics><mrow><mrow><mrow><mrow><mrow><mn>13</mn><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>m</mi></mrow><mo>×</mo><mn>13</mn></mrow><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>m</mi></mrow><mo>×</mo><mn>4</mn></mrow><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">13mm\times 13mm\times 4mm</annotation></semantics></math>) is floating inside a simulated body fluid solution to investigate the degradation process, b) a cross-section of the computational mesh, refined on the metal-medium interface to increase the interface capturing accuracy.</figcaption>
</figure>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection normal">
<div class="section level3">

<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection header-section-number">7.3.5</span> Performance analysis</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p class="ltx_p">To investigate the performance and scaling behavior of the implemented parallel code, we conducted a set of weak-scaling and strong-scaling tests on the computational model. To do this, the time required to solve each PDE in each time step was measured in a simulation. This acted as a rough estimation of the time required in each time step because it ignores all the other factors contributing to speedup results such as communication costs, load imbalance, limited memory bandwidth, and parallelization-caused overhead.</p>
</div>
<div id="S3.SS5.p2" class="ltx_para">
<p class="ltx_p">Weak-scaling was evaluated by dividing the computational domain into smaller sub-domains (each of which was <math id="S3.SS5.p2.m1" class="ltx_Math" alttext="\frac{1}{16}" display="inline"><semantics><mfrac><mn>1</mn><mn>16</mn></mfrac><annotation encoding="application/x-tex">\frac{1}{16}</annotation></semantics></math> of the whole domain, Fig. <a href="#F6" title="Figure 7.6 ‣ 7.3.5 Performance analysis ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.6</span></a>) and conducting simulation experiments with 1, 2, 4, and 8 computational cores in a way that the number of processors corresponded to the number of employed sub-domains. In Fig. <a href="#F6" title="Figure 7.6 ‣ 7.3.5 Performance analysis ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.6</span></a> the upper row shows different domains as an accumulation of the smaller divisions, and the lower row shows the corresponding domain decomposition for parallel computing by depicting each processing unit in a different color. In fact, it demonstrates the concept of increasing the number of MPI processing units as we increase the size of the problem.</p>
</div>
<figure id="F6" class="ltx_figure"><div class="bml-overflow-wrapper"><img src="chapters/hpc/image/weak_scaling_models.jpg" id="F6.g1" class="ltx_graphics ltx_centering" width="541" height="270" alt="Models used for weak-scaling, in which the number of elements was doubled each time while doubling the number of computational cores. Upper row: actual computational domain in which colors show the medium (blue) and the material block (red). Lower row: domain decomposition for parallelization, colors show different decomposed mesh parts (distributed to different MPI processing units). Each column corresponds to a different simulation with a: 1 MPI unit, b: 2 MPI units, c: 4 MPI units, and d: 8 MPI units."></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.6: </span>Models used for weak-scaling, in which the number of elements was doubled each time while doubling the number of computational cores. Upper row: actual computational domain in which colors show the medium (blue) and the material block (red). Lower row: domain decomposition for parallelization, colors show different decomposed mesh parts (distributed to different MPI processing units). Each column corresponds to a different simulation with a: 1 MPI unit, b: 2 MPI units, c: 4 MPI units, and d: 8 MPI units.</figcaption>
</figure>
<div id="S3.SS5.p3" class="ltx_para">
<p class="ltx_p">After calculating the speedup of each test (by comparing the differences in execution time), we can use Gustafson’s law <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib55" title="Reevaluating amdahl’s law" class="ltx_ref">100</a>]</cite> to calculate the sequential and parallelizable portion of computation in the current implementation in weak-scaling evaluation:</p>
<div id="E43" class="ltx_equation ltx_eqn_div">
<span><math id="E43.m1" class="ltx_Math" alttext="\mathrm{Speedup}=f+(1-f)\times N" display="block"><semantics><mrow><mi>Speedup</mi><mo>=</mo><mrow><mi>f</mi><mo>+</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mn>1</mn><mo>-</mo><mi>f</mi></mrow><mo stretchy="false">)</mo></mrow><mo>×</mo><mi>N</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">\mathrm{Speedup}=f+(1-f)\times N</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.43)</span>
              
              
            
</div>
<p class="ltx_p">where <math id="S3.SS5.p3.m1" class="ltx_Math" alttext="N" display="inline"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math> is the total number of computational cores, <math id="S3.SS5.p3.m2" class="ltx_Math" alttext="f" display="inline"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math> is the fraction of operations in the computation that are sequential, and as a result, <math id="S3.SS5.p3.m3" class="ltx_Math" alttext="1-f" display="inline"><semantics><mrow><mn>1</mn><mo>-</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">1-f</annotation></semantics></math> is the fraction of the execution time spent on the parallelizable part.</p>
</div>
<div id="S3.SS5.p4" class="ltx_para">
<p class="ltx_p">The strong-scaling evaluation was performed using the entire domain. The evaluation was done using 1, 8, 16, 40, 60, 90, 200, and 300 MPI cores. In strong-scaling, Amdahl’s law <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib54" title="Validity of the single processor approach to achieving large scale computing capabilities" class="ltx_ref">13</a>]</cite> is used to calculate the portion of the algorithm that runs in parallel:</p>
<div id="E44" class="ltx_equation ltx_eqn_div">
<span><math id="E44.m1" class="ltx_Math" alttext="\mathrm{Speedup}=\frac{1}{f+\frac{1-f}{N}}" display="block"><semantics><mrow><mi>Speedup</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mi>f</mi><mo>+</mo><mfrac><mrow><mn>1</mn><mo>-</mo><mi>f</mi></mrow><mi>N</mi></mfrac></mrow></mfrac></mrow><annotation encoding="application/x-tex">\mathrm{Speedup}=\frac{1}{f+\frac{1-f}{N}}</annotation></semantics></math></span>
              <span class="ltx_tag ltx_tag_equation ltx_align_right">(7.44)</span>
              
              
            
</div>
<p class="ltx_p">in which the parameters are the same as Eq. <a href="#E43" title="(7.43) ‣ 7.3.5 Performance analysis ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.43</span></a>.</p>
</div>
</div>
</section>
<section id="S3.SS6" class="ltx_subsection normal">
<div class="section level3">

<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection header-section-number">7.3.6</span> Compute environment</h3>

<div id="S3.SS6.p1" class="ltx_para">
<p class="ltx_p">Simulations were conducted on the VSC (Flemish Supercomputer Center) supercomputer with the availability of Intel CPUs in three different micro-architectures: Ivy Bridge, Haswell, and Skylake. Due to a better performance, the strong and weak-scaling measurements were solely performed on the Skylake nodes. On this supercomputer, we made use of 3 nodes, 36 cores each, with 576 GB of the total memory, each node holding 2 Intel Xeon Gold 6132 CPUs with a base clock speed of 2.6 GHz. The nodes in the supercomputer are connected using an InfiniBand EDR network (bandwidth 25 Gb/s). For interprocess communication, Intel’s MPI implementation 2018 was used.</p>
</div>
</div>
</section>
</div>
</section>
<section id="S4" class="ltx_section normal">
<div class="section level2">

<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section header-section-number">7.4</span> Results</h2>

<section id="S4.SS1" class="ltx_subsection normal">
<div class="section level3">

<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection header-section-number">7.4.1</span> Numerical simulation results</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p class="ltx_p">The performed numerical simulation produces the output of three main quantities: the concentration of the Mg ions in the medium (as the solution of Eq. <a href="#E10" title="(7.10) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.10</span></a>), the concentration of the protective film (as the solution of Eq. <a href="#E11" title="(7.11) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.11</span></a>), and the level set function values at each element (as the solution of Eq. <a href="#E17" title="(7.17) ‣ 7.2.3 Level-set method ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.17</span></a>). In addition to this, a quantitative prediction of the mass loss is also generated according to Eqs. <a href="#E41" title="(7.41) ‣ 7.3.4 Simulation setup ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.41</span></a> and <a href="#E42" title="(7.42) ‣ 7.3.4 Simulation setup ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.42</span></a>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p class="ltx_p">In order to have quantitative predictions, the coefficients of Eqs. <a href="#E10" title="(7.10) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.10</span></a> and <a href="#E11" title="(7.11) ‣ 7.2.2 Reaction-diffusion equation ‣ 7.2 Background theory and model description ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.11</span></a> (diffusion rates and reaction rates) should be calibrated using an inverse problem. Fig. <a href="#F7" title="Figure 7.7 ‣ 7.4.1 Numerical simulation results ‣ 7.4 Results ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.7</span></a> shows the results produced by the computational model after this parameter estimation stage. A narrow layer of the protective film is formed on the surface of the Mg block, and the volume of produced hydrogen gas is compared with values obtained from experiments. Additionally, by plotting the zero iso-contour of the level set function, we can obtain the shape of the material block as it degrades during the degradation process (i.e. tracking the moving corrosion front). This is depicted by the grey surface in Fig. <a href="#F7" title="Figure 7.7 ‣ 7.4.1 Numerical simulation results ‣ 7.4 Results ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.7</span></a>.</p>
</div>
<figure id="F7" class="ltx_figure"><div class="bml-overflow-wrapper"><img src="chapters/hpc/image/numerical_results.jpg" id="F7.g1" class="ltx_graphics ltx_centering" width="541" height="189" alt="Numerical simulation result. Left: formation of a protective layer on the surface of the Mg block (red region). Right: comparison of the produced hydrogen (a surrogate for the material loss) in the computational model and the experimental data, which is a validation of the full model as both the reaction-diffusion equations and the level-set equation are involved in the computation of this quantity."></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.7: </span>Numerical simulation result. Left: formation of a protective layer on the surface of the Mg block (red region). Right: comparison of the produced hydrogen (a surrogate for the material loss) in the computational model and the experimental data, which is a validation of the full model as both the reaction-diffusion equations and the level-set equation are involved in the computation of this quantity.</figcaption>
</figure>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection normal">
<div class="section level3">

<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection header-section-number">7.4.2</span> Weak and strong scaling results</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p class="ltx_p">Weak-scaling results are plotted in Fig. <a href="#F8" title="Figure 7.8 ‣ 7.4.2 Weak and strong scaling results ‣ 7.4 Results ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.8</span></a>, in which the execution time of each time step is broken down into the time spent on each PDE. The results show good scalability of the parallel implementation.</p>
</div>
<figure id="F8" class="ltx_figure"><div class="bml-overflow-wrapper"><img src="chapters/hpc/image/weak_scaling_results.jpg" id="F8.g1" class="ltx_graphics ltx_centering" width="541" height="167" alt="Weak-scaling test result. Results are broken down into contributions for each PDE, which are plotted cumulatively and separately in the left and right plot, respectively."></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.8: </span>Weak-scaling test result. Results are broken down into contributions for each PDE, which are plotted cumulatively and separately in the left and right plot, respectively.</figcaption>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p class="ltx_p">Speedup and parallel efficiency of the weak-scaling experiment is plotted in Fig. <a href="#F9" title="Figure 7.9 ‣ 7.4.2 Weak and strong scaling results ‣ 7.4 Results ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.9</span></a>. By fitting a curve based on the Gustafson equation (Eq. <a href="#E43" title="(7.43) ‣ 7.3.5 Performance analysis ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.43</span></a>) on the obtained results (Fig. <a href="#F9" title="Figure 7.9 ‣ 7.4.2 Weak and strong scaling results ‣ 7.4 Results ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.9</span></a>), the sequential proportion of the current implementation was calculated to be <math id="S4.SS2.p2.m1" class="ltx_Math" alttext="18\%" display="inline"><semantics><mrow><mn>18</mn><mo>%</mo></mrow><annotation encoding="application/x-tex">18\%</annotation></semantics></math>, which means that <math id="S4.SS2.p2.m2" class="ltx_Math" alttext="82" display="inline"><semantics><mn>82</mn><annotation encoding="application/x-tex">82</annotation></semantics></math> percent of the code can be parallelized, which is a proper but not an ideal scalability.</p>
</div>
<figure id="F9" class="ltx_figure"><div class="bml-overflow-wrapper"><img src="chapters/hpc/image/weak_scaling_analysis.jpg" id="F9.g1" class="ltx_graphics ltx_centering" width="541" height="131" alt="Speed-up and parallel efficiency of the weak-scaling experiment. The orange line in the left plot shows the fitted curve based on the Gustafson equation."></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.9: </span>Speed-up and parallel efficiency of the weak-scaling experiment. The orange line in the left plot shows the fitted curve based on the Gustafson equation.</figcaption>
</figure>
<div id="S4.SS2.p3" class="ltx_para">
<p class="ltx_p">The strong-scaling results are plotted in Fig. <a href="#F10" title="Figure 7.10 ‣ 7.4.2 Weak and strong scaling results ‣ 7.4 Results ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.10</span></a>, which shows a better scalability in comparison to the weak-scaling test. For a better representation, exact measured values are presented in Table <a href="#T1" title="Table 7.1 ‣ 7.4.2 Weak and strong scaling results ‣ 7.4 Results ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.1</span></a>.</p>
</div>
<figure id="F10" class="ltx_figure"><div class="bml-overflow-wrapper"><img src="chapters/hpc/image/strong_scaling_results.jpg" id="F10.g1" class="ltx_graphics ltx_centering" width="541" height="170" alt="Strong-scaling test result. Results are broken down into contributions for each PDE, which are plotted cumulatively and separately in the left and right plot, respectively."></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.10: </span>Strong-scaling test result. Results are broken down into contributions for each PDE, which are plotted cumulatively and separately in the left and right plot, respectively.</figcaption>
</figure>
<figure id="T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7.1: </span>Strong-scaling test result, presented by the execution time of each PDE in simulations with a different number of employed MPI cores.</figcaption><div class="bml-overflow-wrapper">
<table class="ltx_tabular ltx_centering ltx_align_middle">
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2">MPI Size</td>
<td class="ltx_td ltx_align_center ltx_border_tt">1</td>
<td class="ltx_td ltx_align_center ltx_border_tt">8</td>
<td class="ltx_td ltx_align_center ltx_border_tt">16</td>
<td class="ltx_td ltx_align_center ltx_border_tt">40</td>
<td class="ltx_td ltx_align_center ltx_border_tt">60</td>
<td class="ltx_td ltx_align_center ltx_border_tt">90</td>
<td class="ltx_td ltx_align_center ltx_border_tt">200</td>
<td class="ltx_td ltx_align_center ltx_border_tt">300</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><div class="bml-overflow-wrapper">
<table class="ltx_tabular ltx_align_middle">
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center">Solution time</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center">of each time</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center">step (s)</td>
</tr>
</table>
</div></td>
<td class="ltx_td ltx_align_left ltx_border_t">LS PDE</td>
<td class="ltx_td ltx_align_center ltx_border_t">9</td>
<td class="ltx_td ltx_align_center ltx_border_t">1.39</td>
<td class="ltx_td ltx_align_center ltx_border_t">0.75</td>
<td class="ltx_td ltx_align_center ltx_border_t">0.36</td>
<td class="ltx_td ltx_align_center ltx_border_t">0.26</td>
<td class="ltx_td ltx_align_center ltx_border_t">0.19</td>
<td class="ltx_td ltx_align_center ltx_border_t">0.11</td>
<td class="ltx_td ltx_align_center ltx_border_t">0.07</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_left">Mg PDE</td>
<td class="ltx_td ltx_align_center">13.04</td>
<td class="ltx_td ltx_align_center">1.76</td>
<td class="ltx_td ltx_align_center">0.94</td>
<td class="ltx_td ltx_align_center">0.46</td>
<td class="ltx_td ltx_align_center">0.31</td>
<td class="ltx_td ltx_align_center">0.22</td>
<td class="ltx_td ltx_align_center">0.12</td>
<td class="ltx_td ltx_align_center">0.09</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_left">Film PDE</td>
<td class="ltx_td ltx_align_center">6.38</td>
<td class="ltx_td ltx_align_center">0.84</td>
<td class="ltx_td ltx_align_center">0.45</td>
<td class="ltx_td ltx_align_center">0.21</td>
<td class="ltx_td ltx_align_center">0.14</td>
<td class="ltx_td ltx_align_center">0.09</td>
<td class="ltx_td ltx_align_center">0.05</td>
<td class="ltx_td ltx_align_center">0.04</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" colspan="2">Total time (s)</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">28.42</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">3.99</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">2.14</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">1.03</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.71</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.5</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.28</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.2</td>
</tr>
</table>
</div>
</figure>
<div id="S4.SS2.p4" class="ltx_para">
<p class="ltx_p">Similar to weak-scaling results, Fig. <a href="#F11" title="Figure 7.11 ‣ 7.4.2 Weak and strong scaling results ‣ 7.4 Results ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.11</span></a> demonstrates the speedup and parallel efficiency of the developed code for strong-scaling evaluation. From the results, it is obvious that increasing the number of cores leads to a better performance but a lower efficiency. By fitting Amdahl’s equation (Eq. <a href="#E44" title="(7.44) ‣ 7.3.5 Performance analysis ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.44</span></a>) on the obtained speedup results (Fig. <a href="#F11" title="Figure 7.11 ‣ 7.4.2 Weak and strong scaling results ‣ 7.4 Results ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.11</span></a>), <math id="S4.SS2.p4.m1" class="ltx_Math" alttext="f" display="inline"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math> was obtained as <math id="S4.SS2.p4.m2" class="ltx_Math" alttext="0.01" display="inline"><semantics><mn>0.01</mn><annotation encoding="application/x-tex">0.01</annotation></semantics></math>, which means in strong-scaling terms that <math id="S4.SS2.p4.m3" class="ltx_Math" alttext="99\%" display="inline"><semantics><mrow><mn>99</mn><mo>%</mo></mrow><annotation encoding="application/x-tex">99\%</annotation></semantics></math> of the code can run in parallel.</p>
</div>
<figure id="F11" class="ltx_figure"><div class="bml-overflow-wrapper"><img src="chapters/hpc/image/strong_scaling_analysis.jpg" id="F11.g1" class="ltx_graphics ltx_centering" width="541" height="134" alt="Speed-up and parallel efficiency of the strong-scaling experiment. The orange line in the left plot is the fitted equation based on the Amdahl rule."></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.11: </span>Speed-up and parallel efficiency of the strong-scaling experiment. The orange line in the left plot is the fitted equation based on the Amdahl rule.</figcaption>
</figure>
</div>
</section>
</div>
</section>
<section id="S5" class="ltx_section normal">
<div class="section level2">

<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section header-section-number">7.5</span> Discussion</h2>

<div id="S5.p1" class="ltx_para">
<p class="ltx_p">In this investigation, the derivation and implementation of a reaction-diffusion model with moving boundaries were presented. Such an approach finds application in many scientific and engineering problems. The target application in the current work was the degradation of a bulk metal cuboid in a liquid environment, specifically Mg in an aqueous ion solution as a representative for temporary medical devices. The simulations were based on the corrosion of Mg metal to Mg ions to form a film of Mg hydroxide that partially protects the metal block from further degradation except where this film is impacted by reaction with other ions in the environment (such as chloride ion). The reactive moving boundary problem was cast in the form of equations in which the change of the concentrations of the different chemical components is represented by parabolic PDEs. The coupled equations depend on several kinetic constants that have been calibrated from experiments. The moving interface between the metal bulk and the liquid phase was described by an implicit function using the level set method. The derivation led to equations that require the use of numerical techniques for which a combination of finite difference and finite element methods was implemented. As the required high accuracy on the moving interface results in an increase in computation time, parallelization was crucial for the computational model to decrease the execution time of the simulations. The results of the total execution time in each time step (Table <a href="#T1" title="Table 7.1 ‣ 7.4.2 Weak and strong scaling results ‣ 7.4 Results ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.1</span></a>) clearly indicate that without the parallelization, the simulation of the model is slow and as a result, less interactable for real-world simulation analyses. Considering the properly employed parallelization, the computational time has been decreased noticeably for the investigated case-study.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p class="ltx_p">The output of the conducted numerical simulation demonstrates that the developed mathematical model is capable of capturing the degradation interface movement and of modeling of the underlying chemical phenomena. The predicted mass loss is in line with the experimental results, and the simulated corrosion behavior is as expected for such a system. It is worth noting that the chosen system is highly idealized as a model for medical devices. A more realistic chemical environment would contain many more species that play a role in the formation of either soluble ions or the protective film. Moreover, in real-world scenarios, corrosion occurs in a more complex way than the simplified one described in this paper, which will have a significant influence on the local concentration of ions in the regions close to the solid surface. Nevertheless, the developed framework is capable of capturing these physical and chemical phenomena in the future by simply adding the appropriate terms to the base PDEs without any major changes in the computational model. Furthermore, although it requires some changes to the parallelization approach, the addition of the fluid flow around the block is feasible by adding convective terms to form a reaction-diffusion-convection system. Such a system can be used to model relevant systems such as experimental bioreactor setups in biology and medical sciences.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p class="ltx_p">The parallel algorithm was implemented using a domain decomposition method. Standard domain decomposition preconditioners, such as restricted additive Schwarz, are widely used for parallel implementation of computational models. In a parallel implementation, such preconditioners bring the benefit of relatively low communication costs <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib62" title="A multilevel schwarz preconditioner based on a hierarchy of robust coarse spaces" class="ltx_ref">62</a>]</cite>. Beside this, the formed linear system of equations in each partition of the mesh was solved using Krylov methods by taking advantage of the highly-efficient preconditioners and iterative solvers of the PETSc library. According to the obtained results, the employed parallelization approach of the current study yields reasonable scaling with respect to the available computational resources (or the number of sub-domains). Out of multiple evaluations, the best performance was achieved using the preconditioner/solver combination of HYPRE/GMRES, which is in agreement with findings in more specific studies in this regard <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib104" title="A comparison of preconditioned krylov subspace methods for large-scale nonsymmetric linear systems" class="ltx_ref">88</a>]</cite>.</p>
</div>
<div id="S5.p4" class="ltx_para">
<p class="ltx_p">To evaluate the scaling performance of the implemented parallelism, a set of weak and strong scaling tests was conducted. In weak-scaling, the main approach is changing the problem size proportional to the change in the available computing resources. In an ideal parallelization, we expect that the speedup remains the same for all the setups because we provide double resources as we double the size of the problem. In strong-scaling, the size of the problem remains constant, but the number of computing units increases. So, in an ideal case, we should observe a double speedup as the number of computing units doubles.
By fitting Gustafson’s and Amdahl’s laws on the scaling test results (Figs. <a href="#F9" title="Figure 7.9 ‣ 7.4.2 Weak and strong scaling results ‣ 7.4 Results ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.9</span></a> and <a href="#F11" title="Figure 7.11 ‣ 7.4.2 Weak and strong scaling results ‣ 7.4 Results ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.11</span></a>), the maximum parallelizable portion of the code was calculated to be 82% and 99% for the weak-scaling and strong-scaling tests, respectively. This is a reasonable theoretical scaling for both cases. However, it should be noted that Gustafson’s and Amdahl’s laws are only applicable and valid for ideal parallelization cases, a fact that can be considered as the simplification made for performing the analysis made in the current research.</p>
</div>
<div id="S5.p5" class="ltx_para">
<p class="ltx_p">The obtained scaling behavior is similar to other conducted studies for diffusion or diffusion-convection systems <cite class="ltx_cite ltx_citemacro_cite">[<a href="bib.html#bib103" title="Parallel implementation of the diffusion–drift algorithm for modeling the electrophysiological activity of breast tumors" class="ltx_ref">111</a>, <a href="bib.html#bib102" title="Fully resolved simulations of dune formation in riverbeds" class="ltx_ref">215</a>]</cite>, in which the efficiency of the parallelization decreases with increasing the number of available computational resources. The reason behind this behavior in the current model seems to lie in the mesh partitioning process. Indeed, the mesh is partitioned into semi-equal partitions, each of which has the same number of elements, but the main computation is only carried out on the nodes located outside the degrading material block (i.e. in the medium). In other words, the computational resources assigned to the nodes inside the material bulk do not contribute significantly to the simulation. This limitation can be prevented by modifying the mesh generation process in a way that a lower number of elements be generated inside the material block, but doing this requires remeshing of the interior region as the moving interface approaches it, which imposes even more complexity to the algorithm due to the partitioned mesh. Another bottleneck of the current model, as discussed before, routed in the non-constant right-hand matrix of the linear system (Eq. <a href="#E33" title="(7.33) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.33</span></a>), which requires computing the <math id="S5.p5.m1" class="ltx_Math" alttext="A" display="inline"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math> matrix (Eq. <a href="#E34" title="(7.34) ‣ 7.3.1 Finite element discretization (bottleneck of the algorithm) ‣ 7.3 Methodology of model implementation ‣ Chapter 7 Model parallelization for high-performance computing ‣ Mathematical and computational modeling of metallic biomaterials biodegradation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.34</span></a>) in each time step and leads to a slower execution time.</p>
</div>
<div id="S5.p6" class="ltx_para">
<p class="ltx_p">One important point in this regard is that the way that the results are interpreted does not necessarily imply the true scaling behavior of the system. Indeed, it is more like a surrogate model of the system performance. The correct methodology for obtaining true scaling factors is rather starting from an analysis of the code and time used in each routine for a non-parallel run. Then, based on the fraction of routines that are possible to execute in parallel, one can get a theoretical limit for the speedup. This will be reduced by practical limitations such as load balancing and communication costs of the network. Since it is a theoretical limit, it is not fully correct to ignore those extra parts and use the execution time to invert the relation to predict the fraction of the code that is parallel. However, for a complex computational model like the one that was developed in the current study, doing such a measurement of each routine is very difficult due to the complexity of the orchestrated libraries and tools. As a result, we were limited to use the roughly approximated speedup limit to evaluate the scaling of the constructed model. Regarding the scalability results, it is worth mentioning that although having studies with thousands of MPI ranks is more common in this field, due to the limitation we faced in accessing computational resources, the maximum number of employed cores were limited to 300. The goal of the current study was to demonstrate the scalability of the developed model on massively parallel systems, and the behavior of the model in moving from 90 cores to 300 shows the consistency in the performed performance analysis. As a result, we expect to see the same scalability behavior for problems in a larger scale with a higher number of employed computing nodes.</p>
</div>
</div>
</section>
<section id="S6" class="ltx_section normal">
<div class="section level2">

<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section header-section-number">7.6</span> Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p class="ltx_p">In this work, a mathematical model of a reaction-diffusion system with a moving front was constructed, and the corresponding computational model was implemented using the finite element method. In order to correlate the diffusion phenomenon to the moving boundary position, high numerical accuracy is necessary at the diffusion interface, which requires a finer discretization of space near the moving front. This leads to an expensive computational model, which makes employing HPC techniques crucial in order to improve the simulation execution time. To this end, a high-performance domain decomposition approach was employed to partition the mesh and distribute the workload to available computing resources. Additionally, an efficient preconditioner/solver combination for reaction-diffusion PDEs was used to optimize the model to be used for the high-performance simulation of large scale systems in which the movement of system boundaries is controlled by reaction-diffusion phenomena.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p class="ltx_p">The investigated problem was the degradation of a magnesium block inside a solution, in which the surface of the block moves due to the reaction-diffusion phenomena in the metal-medium interface. The implemented model showed a good agreement with the experimental data in terms of the degradation rate and chemical reactions, and the parallel efficiency and linear scalability were appropriate in performance evaluation tests. For the next stage of the study, it could be interesting to evaluate the model and its performance on a much larger system and tune the resources and memory usage by testing different preconditioners and solvers.</p>
</div>
</div>
</section>
<section id="A1" class="ltx_appendix normal">
<div class="section level1">

<h1 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix header-section-number">Appendix 7.A</span> Comparing the performance of different combinations of KSP types and preconditioners</h1>

<div id="A1.p1" class="ltx_para">
<p class="ltx_p">In order to yield the highest performance, a variety of different
combinations of KSP types and preconditioners were evaluated, such
as Conjugate Gradients (CG), Successive Over-Relaxation (SOR),
block Jacobi, and Algebraic Multigrid (AMG), and Generalized Minimal Residual Method (GMRES). The tests were performed using 6 MPI cores on an Ubuntu machine with an Intel Core i7-8850H CPU (2.6 GHz of clock speed) and a total available memory of 32 GB.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure id="F12" class="ltx_figure"><div class="bml-overflow-wrapper"><img src="chapters/hpc/image/compare.jpg" id="F12.g1" class="ltx_graphics ltx_centering" width="541" height="248" alt="Performance test result for various combinations of preconditioners and solvers. Results are broken down into contributions for each PDE, which are plotted cumulatively and separately in the left and right plots, respectively."></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7.12: </span>Performance test result for various combinations of preconditioners and solvers. Results are broken down into contributions for each PDE, which are plotted cumulatively and separately in the left and right plots, respectively.</figcaption>
</figure>
<figure id="T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7.2: </span>Performance test result for various combinations of preconditioners and solvers, presented by the execution time of each PDE.</figcaption><div class="bml-overflow-wrapper">
<table class="ltx_tabular ltx_centering ltx_align_middle">
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2">
<div class="ltx_inline-block ltx_transformed_outer" style="width:0.0pt;height:0pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:0.0pt;transform:translate(0pt,0pt) rotate(-90deg) ;">
</span></div>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt">
<div class="ltx_inline-block ltx_transformed_outer" style="width:10.8pt;height:144pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:144.0pt;transform:translate(-66.6pt,-65.4pt) rotate(-90deg) ;">
<p class="ltx_p">B Jacobi / GMRES</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt">
<div class="ltx_inline-block ltx_transformed_outer" style="width:10.8pt;height:117pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:117.0pt;transform:translate(-53.1pt,-51.9pt) rotate(-90deg) ;">
<p class="ltx_p">B Jacobi / CG</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt">
<div class="ltx_inline-block ltx_transformed_outer" style="width:10.8pt;height:117pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:117.0pt;transform:translate(-53.1pt,-51.9pt) rotate(-90deg) ;">
<p class="ltx_p">HYPRE / GMRES</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt">
<div class="ltx_inline-block ltx_transformed_outer" style="width:10.8pt;height:90pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:90.0pt;transform:translate(-39.6pt,-38.4pt) rotate(-90deg) ;">
<p class="ltx_p">HYPRE / CG</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt">
<div class="ltx_inline-block ltx_transformed_outer" style="width:10.8pt;height:108pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:108.0pt;transform:translate(-48.6pt,-47.4pt) rotate(-90deg) ;">
<p class="ltx_p">GAMG / GMRES</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt">
<div class="ltx_inline-block ltx_transformed_outer" style="width:10.8pt;height:81pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:81.0pt;transform:translate(-35.1pt,-33.9pt) rotate(-90deg) ;">
<p class="ltx_p">GAMG / CG</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt">
<div class="ltx_inline-block ltx_transformed_outer" style="width:10.8pt;height:99pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:99.0pt;transform:translate(-44.1pt,-42.9pt) rotate(-90deg) ;">
<p class="ltx_p">SOR / GMRES</p>
</span></div>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt">
<div class="ltx_inline-block ltx_transformed_outer" style="width:10.8pt;height:72pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:72.0pt;transform:translate(-30.6pt,-29.4pt) rotate(-90deg) ;">
<p class="ltx_p">SOR / CG</p>
</span></div>
</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><div class="bml-overflow-wrapper">
<table class="ltx_tabular ltx_align_middle">
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center">Solution time</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center">of each time</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center">step (s)</td>
</tr>
</table>
</div></td>
<td class="ltx_td ltx_align_left ltx_border_t">LS PDE</td>
<td class="ltx_td ltx_align_center ltx_border_t">2.4</td>
<td class="ltx_td ltx_align_center ltx_border_t">2.9</td>
<td class="ltx_td ltx_align_center ltx_border_t">2.1</td>
<td class="ltx_td ltx_align_center ltx_border_t">2.9</td>
<td class="ltx_td ltx_align_center ltx_border_t">3.0</td>
<td class="ltx_td ltx_align_center ltx_border_t">2.9</td>
<td class="ltx_td ltx_align_center ltx_border_t">2.5</td>
<td class="ltx_td ltx_align_center ltx_border_t">2.5</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_left">Mg PDE</td>
<td class="ltx_td ltx_align_center">3.4</td>
<td class="ltx_td ltx_align_center">4.1</td>
<td class="ltx_td ltx_align_center">3.1</td>
<td class="ltx_td ltx_align_center">3.8</td>
<td class="ltx_td ltx_align_center">3.9</td>
<td class="ltx_td ltx_align_center">4.3</td>
<td class="ltx_td ltx_align_center">3.4</td>
<td class="ltx_td ltx_align_center">3.5</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_left">Film PDE</td>
<td class="ltx_td ltx_align_center">1.8</td>
<td class="ltx_td ltx_align_center">2.0</td>
<td class="ltx_td ltx_align_center">1.6</td>
<td class="ltx_td ltx_align_center">2.2</td>
<td class="ltx_td ltx_align_center">2.1</td>
<td class="ltx_td ltx_align_center">2.6</td>
<td class="ltx_td ltx_align_center">1.7</td>
<td class="ltx_td ltx_align_center">1.8</td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" colspan="2">Total time (s)</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">7.6</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">9.0</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">6.8</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">8.9</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">9.0</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">9.8</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">7.6</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">7.8</td>
</tr>
</table>
</div>
</figure>
</div>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</div>
</section>
</div>
</div>
</div>
<a href="Ch6.html" class="navigation navigation-prev" aria-label="Previous page"><i class="fa fa-angle-left"></i></a><a href="Ch8.html" class="navigation navigation-next" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
</div>
</div>
<script src="bookml/gitbook/js/app.min.js"></script>
<script src="bookml/gitbook/js/jquery.highlight.js"></script>
<script src="bookml/gitbook/js/plugin-search.js"></script>
<script src="bookml/gitbook/js/plugin-fontsettings.js"></script>
<script src="bookml/gitbook/js/plugin-bookdown.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script>
        MathJax = {
          startup: {
            ready() {
              // do not process equations disabled with \bmlDisableMathJax (code suggested by Davide P. Cervone)
              class bmlFindMathML extends MathJax._.input.mathml.FindMathML.FindMathML {
                processMath(set) {
                  const adaptor = this.adaptor;
                  for (const node of set.values()) {
                    if (adaptor.hasClass(node, 'bml_disable_mathjax')) {
                      set.delete(node);
                    }
                  }
                  return super.processMath(set);
                }
              }

              MathJax._.components.global.combineDefaults(MathJax.config, 'mml', {FindMathML: new bmlFindMathML()});

              MathJax.startup.defaultReady();

              // preproces MathML to make MathJax aware of certain LaTeXML and BookML additional info
              const mmlFilters = MathJax.startup.input[0].mmlFilters;

              // convert the LaTeXML calligraphic (chancery) annotation to a form MathJax understands
              // since the corresponding Unicode characters render as script (rounded)
              const script2latin = {
                '𝒜': 'A', 'ℬ': 'B', '𝒞': 'C', '𝒟': 'D', 'ℰ': 'E', 'ℱ': 'F', '𝒢': 'G',
                'ℋ': 'H', 'ℐ': 'I', '𝒥': 'J', '𝒦': 'K', 'ℒ': 'L', 'ℳ': 'M', '𝒩': 'N',
                '𝒪': 'O', '𝒫': 'P', '𝒬': 'Q', 'ℛ': 'R', '𝒮': 'S', '𝒯': 'T', '𝒰': 'U',
                '𝒱': 'V', '𝒲': 'W', '𝒳': 'X', '𝒴': 'Y', '𝒵': 'Z',
              };

              mmlFilters.add((args) => {
                for (const n of args.data.getElementsByClassName('ltx_font_mathcaligraphic')) {
                  n.classList.add('MJX-tex-calligraphic');
                  const letter = script2latin[n.textContent];
                  if (letter !== undefined) { n.textContent = letter; }
                }
              });

              // adjust characters based on Unicode variation sequences
              const replacements = {
                // MathJax renders the empty set as the U+FE00 variant, so the plain character needs adjusting
                '∅': { variant: 'variant' },
                // MathJax renders script characters in rounded style, which is fine for no variation and U+FE00
                '𝒜\xFE00': { text: 'A', variant: 'tex-calligraphic' },
                'ℬ\xFE00': { text: 'B', variant: 'tex-calligraphic' },
                '𝒞\xFE00': { text: 'C', variant: 'tex-calligraphic' },
                '𝒟\xFE00': { text: 'D', variant: 'tex-calligraphic' },
                'ℰ\xFE00': { text: 'E', variant: 'tex-calligraphic' },
                'ℱ\xFE00': { text: 'F', variant: 'tex-calligraphic' },
                '𝒢\xFE00': { text: 'G', variant: 'tex-calligraphic' },
                'ℋ\xFE00': { text: 'H', variant: 'tex-calligraphic' },
                'ℐ\xFE00': { text: 'I', variant: 'tex-calligraphic' },
                '𝒥\xFE00': { text: 'J', variant: 'tex-calligraphic' },
                '𝒦\xFE00': { text: 'K', variant: 'tex-calligraphic' },
                'ℒ\xFE00': { text: 'L', variant: 'tex-calligraphic' },
                'ℳ\xFE00': { text: 'M', variant: 'tex-calligraphic' },
                '𝒩\xFE00': { text: 'N', variant: 'tex-calligraphic' },
                '𝒪\xFE00': { text: 'O', variant: 'tex-calligraphic' },
                '𝒫\xFE00': { text: 'P', variant: 'tex-calligraphic' },
                '𝒬\xFE00': { text: 'Q', variant: 'tex-calligraphic' },
                'ℛ\xFE00': { text: 'R', variant: 'tex-calligraphic' },
                '𝒮\xFE00': { text: 'S', variant: 'tex-calligraphic' },
                '𝒯\xFE00': { text: 'T', variant: 'tex-calligraphic' },
                '𝒰\xFE00': { text: 'U', variant: 'tex-calligraphic' },
                '𝒱\xFE00': { text: 'V', variant: 'tex-calligraphic' },
                '𝒲\xFE00': { text: 'W', variant: 'tex-calligraphic' },
                '𝒳\xFE00': { text: 'X', variant: 'tex-calligraphic' },
                '𝒴\xFE00': { text: 'Y', variant: 'tex-calligraphic' },
                '𝒵\xFE00': { text: 'Z', variant: 'tex-calligraphic' }
              };

              mmlFilters.add((args) => {
                let nodes = document.evaluate('.//m:mi | .//m:mn | .//m:mo | .//m:ms', args.data,
                  () => 'http://www.w3.org/1998/Math/MathML', XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE);
                for (let i = 0; i < nodes.snapshotLength; i++) {
                  const n = nodes.snapshotItem(i);
                  const repl = replacements[n.innerHTML];
                  if (repl !== undefined) {
                    const variant = repl['variant'];
                    const text = repl['text'];
                    if (variant !== undefined) { n.classList.add('MJX-' + variant); n.removeAttribute('mathvariant'); }
                    if (text !== undefined) { n.innerHTML = text; }
                  }
                }
              });
            }
          }
        };
      </script>
<script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js"></script>
<script type="text/javascript">
                gitbook.require(["gitbook"], function(gitbook) {
                gitbook.start({
                  "fontsettings": {
                    "theme": "white",
                    "family": "sans",
                    "size": 2
                  },
                  "download": [ [ "thesis.pdf", "PDF" ], ],
                  "search": {
                    "engine": "fuse"
                  },
                  "toc": {
                    "collapse": "none"
                  }
                });
              });
            </script>
</body>

</html>
